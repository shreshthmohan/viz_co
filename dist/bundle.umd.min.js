!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("d3"),require("lodash-es"),require("d3-sankey")):"function"==typeof define&&define.amd?define(["exports","d3","lodash-es","d3-sankey"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).viz={},e.d3,e._,e.d3)}(this,(function(e,t,a,i){"use strict";function n(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}function s(e){if(e&&e.__esModule)return e;var t=Object.create(null);return e&&Object.keys(e).forEach((function(a){if("default"!==a){var i=Object.getOwnPropertyDescriptor(e,a);Object.defineProperty(t,a,i.get?i:{enumerable:!0,get:function(){return e[a]}})}})),t.default=e,Object.freeze(t)}var o=s(t),r=n(a);const l=function(e,t="",a=!1){const i=o.format(t)(e);return a?i:r.default.replace(i,"G","B")},c=function(e,t=null,a=null){const i=o.timeParse(t)(e);return(i?o.timeFormat(a)(i):null)||e};function d(e){return e.replace(/[\s&',.]/g,"").toLowerCase()}function m({allComponents:e,svg:t,safetyMargin:a=5,margins:i}){const{marginLeft:n,marginRight:s,marginTop:o,marginBottom:r}=i;let l=e.node().getBBox();const c=l.width+a+n+s,d=l.height+a+o+r;t.attr("viewBox",`0 0 ${c} ${d}`),l=e.node().getBBox(),e.attr("transform",`translate(${-l.x+a/2+n}, ${-l.y+a/2+o})`)}const p=a.throttle(m,500);function g(e,t){return Math.atan(e/(2*Math.sqrt(t**2-(e/2)**2)))}function h({x1:e,y1:t,x2:a,y2:i,circleRadius:n,stickWidth:s}){const o=function({x1:e,y1:t,x2:a,y2:i}){return Math.sqrt((e-a)**2+(t-i)**2)}({x1:e,y1:t,x2:a,y2:i}),r=n,l=(c=s,d=o,Math.sqrt((c/2)**2+d**2));var c,d;const m=function({r1:e,r2:t,wl:a,pointCount:i=50}){const n=[[g(a,t),t],[g(a,e),e]],s=[[2*Math.PI-g(a,e),e],[2*Math.PI-g(a,t),t],[g(a,t),t]],o=i,r=[],l=g(a,e),c=(2*Math.PI-l-l)/o;for(let t=1;t<o;t++)r.push([l+t*c,e]);return[...n,...r,...s]}({r1:r,r2:l<r?r:l,wl:s});return m}function u({chartCore:e,dataParsed:t,sizeField:a,nameField:i,defaultStateAll:n,xFieldStart:s,xFieldEnd:c,xScale:m,yScale:p,yFieldStart:g,yFieldEnd:u,circleSizeScale:y,lineWidthScale:f,colorScale:x,tooltipDiv:v,sizeValueFormatter:b,xValueFormatter:F,yValueFormatter:S,xFieldType:C,yFieldType:$}){const w=e.append("g").attr("class","maces").selectAll("g").data(t).join("g").sort(((e,t)=>o.descending(e[a],t[a]))).attr("class",(e=>`mace\n        ${e.slope>=0?"mace-same":"mace-opposite"}\n        mace-${d(e[i])}\n        ${n.includes(e[i])?"mace-active":""}`)).on("click",(e=>{const t=o.select(e.target.parentNode),a=t.classed("mace-active");t.classed("mace-active",!a)}));w.append("path").attr("d",(e=>{const t=h({x1:m(e[s]),y1:p(e[g]),x2:m(e[c]),y2:p(e[u]),circleRadius:y(e[a]),stickWidth:f(e[a])});return o.lineRadial()(t)})).attr("transform",(e=>{const t=m(e[s]),a=p(e[g]),i=m(e[c]),n=p(e[u]),o=function({x1:e,y1:t,x2:a,y2:i}){const n=180*Math.atan((t-i)/(e-a))/Math.PI;return a-e>0?n-90:n+90}({x1:t,y1:a,x2:i,y2:n});return`translate(${i}, ${n}) rotate(${o})`})).attr("fill",(e=>x(e.slope))).attr("stroke-linecap","square"),w.on("mouseover",((e,t)=>{o.select(e.target.parentNode).classed("mace-hovered",!0),v.transition().duration(200).style("opacity",1);const n=l(t[a],b),d=l(t[s],F),m=l(t[c],F),p=l(t[g],S),h=l(t[u],S);v.html(`${t[i]}\n        <br/>\n        ${C}: ${d} → ${m}\n        <br />\n        ${$}: ${p} → ${h}\n        <br />\n        ${r.default.capitalize(a)}: ${n}\n        `),v.style("left",`${e.clientX}px`).style("top",`${e.clientY+20+window.scrollY}px`)})).on("mouseout",(e=>{o.select(e.target.parentNode).classed("mace-hovered",!1),v.style("left","-300px").transition().duration(500).style("opacity",0)}))}function y({data:e,options:{aspectRatio:t=2,marginTop:a=0,marginRight:i=0,marginBottom:n=0,marginLeft:s=0,bgColor:c="transparent",oppositeDirectionColor:p="#ee4e34",sameDirectionColor:g="#44a8c1",yAxisTitle:h="y axis title",xAxisTitle:y="x axis title",xValueFormatter:f="",yValueFormatter:x="",directionStartLabel:v="start point",directionEndLabel:b="end point",sizeLegendValues:F=[1e6,1e8,1e9],sizeLegendMoveSizeObjectDownBy:S=5,sizeLegendTitle:C="size legend title",sizeValueFormatter:$="",xAxisTickValues:w,xScaleType:k="linear",xScaleLogBase:L=10,defaultState:z=[],activeOpacity:B=.8,inactiveOpacity:A=.2,circleSizeRange:R=[5,30],lineWidthRange:T=[2,4],searchInputClassNames:N="",goToInitialStateButtonClassNames:D="",clearAllButtonClassNames:E="",xFieldType:I=`${P} → ${V}`,yFieldType:O=`${W} → ${G}`},dimensions:{xFieldStart:P,xFieldEnd:V,yFieldStart:W,yFieldEnd:G,sizeField:H,nameField:Y},chartContainerSelector:j}){!function({activeOpacity:e,inactiveOpacity:t}){o.select("body").append("style").html(`\n    g.maces .mace {\n      fill-opacity: ${t};\n    }\n    /* clicked and legend clicked states are common: controlled by .mace-active */\n    g.maces .mace.mace-active {\n      fill-opacity: ${e};\n    }\n    g.maces.searching .mace.mace-matched {\n      stroke: #333;\n      stroke-width: 3;\n    }\n    /* So that legend text is visible irrespective of state */\n    g.mace text {\n      fill-opacity: 0.8;\n    }\n    g.maces g.mace.mace-hovered {\n      stroke: #333;\n      stroke-width: 3;\n    }\n    g.color-legend g.mace-active {\n      fill-opacity: ${e};\n    }\n    g.color-legend g:not(.mace-active) {\n      fill-opacity: ${t};\n    }\n  `)}({activeOpacity:B,inactiveOpacity:A});const q=1e3,{svg:M,coreChartHeight:_,allComponents:X,chartCore:J,widgetsLeft:Q,widgetsRight:U}=function({chartContainerSelector:e,coreChartWidth:t,aspectRatio:a,marginTop:i,marginBottom:n,marginLeft:s,marginRight:r,bgColor:l}){const c=t/a,d=c+i+n,m=t+s+r,p=o.select(e),g=p.append("div").attr("style","display: flex; justify-content: space-between; padding-bottom: 0.5rem;"),h=g.append("div").attr("style","display: flex; align-items: end; column-gap: 5px;"),u=g.append("div").attr("style","display: flex; align-items: center; column-gap: 10px;"),y=p.append("svg").attr("viewBox",`0 0 ${m} ${d}`).style("background",l),f=y.append("g").attr("class","all-components"),x=f.append("g").attr("transform",`translate(${s}, ${i})`);return{svg:y,coreChartHeight:c,allComponents:f,chartCore:x,widgetsLeft:h,widgetsRight:u}}({chartContainerSelector:j,coreChartWidth:q,aspectRatio:t,marginTop:a,marginBottom:n,marginLeft:s,marginRight:i,bgColor:c}),K=o.select("body").append("div").attr("class","dom-tooltip").attr("style","opacity: 0; position: absolute; text-align: center; background-color: white; border-radius: 0.25rem; padding: 0.25rem 0.5rem; font-size: 0.75rem; line-height: 1rem; border-width: 1px;"),Z=function({data:e,xFieldStart:t,xFieldEnd:a,yFieldStart:i,yFieldEnd:n,sizeField:s}){return e.map((e=>{const o={...e};return o[t]=Number.parseFloat(e[t]),o[a]=Number.parseFloat(e[a]),o[i]=Number.parseFloat(e[i]),o[n]=Number.parseFloat(e[n]),o[s]=Number.parseFloat(e[s]),o.slope=(o[n]-o[i])/(o[a]-o[t]),o})).filter((e=>!Number.isNaN(e.slope)))}({data:e,xFieldStart:P,xFieldEnd:V,yFieldStart:W,yFieldEnd:G,sizeField:H}),{yScale:ee,xScale:te,circleSizeScale:ae,lineWidthScale:ie,colorScale:ne}=function({dataParsed:e,coreChartHeight:t,coreChartWidth:a,yFieldStart:i,yFieldEnd:n,xFieldStart:s,xFieldEnd:r,xScaleType:l,xScaleLogBase:c,sizeField:d,circleSizeRange:m,lineWidthRange:p,sameDirectionColor:g,oppositeDirectionColor:h}){const u=e.map((e=>Number.parseFloat(e[i]))),y=e.map((e=>Number.parseFloat(e[n]))),f=o.extent([...u,...y]),x=o.scaleLinear().range([t,0]).domain(f).nice(),v=e.map((e=>Number.parseFloat(e[s]))),b=e.map((e=>Number.parseFloat(e[r]))),F=o.extent([...v,...b]),S="log"===l?o.scaleLog().base(c||10).range([0,a]).domain(F).nice():o.scaleLinear().range([0,a]).domain(F).nice(),C=o.max(e.map((e=>e[d])));return{yScale:x,xScale:S,circleSizeScale:o.scaleSqrt().range(m).domain([0,C]),lineWidthScale:o.scaleSqrt().range(p).domain([0,C]),colorScale:e=>e>0?g:h}}({dataParsed:Z,coreChartHeight:_,coreChartWidth:q,yFieldStart:W,yFieldEnd:G,xFieldStart:P,xFieldEnd:V,xScaleType:k,xScaleLogBase:L,sizeField:H,circleSizeRange:R,lineWidthRange:T,sameDirectionColor:g,oppositeDirectionColor:p}),se=r.default(e).map(Y).uniq().value(),oe="All"===z?se:z;!function({gapInCircles:e,circleSizeScale:t,widgetsRight:a,sizeLegendMoveSizeObjectDownBy:i,sizeLegendValues:n,sizeValueFormatter:s,sizeLegendTitle:o}){const r=n.map((e=>t(e)));let c=0;const d=[];r.forEach(((e,t)=>{c+=0===t?e:r[t-1]+r[t],d.push(c)}));const m=a.append("svg"),p=m.append("g");p.append("g").attr("class","g-size-container").attr("transform",`translate(0, ${i})`).selectAll(".g-size-circle").data(r).enter().append("g").attr("class","g-size-circle").append("circle").attr("r",(e=>e)).style("fill","transparent").style("stroke-width",1).style("stroke","gray").attr("cx",((t,a)=>d[a]+a*e+1)).attr("cy",r[r.length-1]+1),p.selectAll(".g-size-circle").append("text").attr("alignment-baseline","middle").attr("dy",r[r.length-1]+2).attr("dx",((t,a)=>t+d[a]+(a+.1)*e)).style("font-size",8).text(((e,t)=>l(n[t],s))),p.append("text").attr("alignment-baseline","hanging").style("font-size",10).style("font-weight",600).text(o);const g=p.node().getBBox();m.attr("height",g.height).attr("width",g.width)}({gapInCircles:30,circleSizeScale:ae,widgetsRight:U,sizeLegendMoveSizeObjectDownBy:S,sizeLegendValues:F,sizeValueFormatter:$,sizeLegendTitle:C});!function({stickHeight:e,stickLength:t,ballRadius:a,gapForText:i,singleMaceSectionHeight:n,widgetsRight:s,sameDirectionColor:r,oppositeDirectionColor:l}){const c=s.append("svg"),d=c.append("g").attr("class","color-legend cursor-pointer").attr("transform",`translate(0, ${-(n-a)})`),m=d.append("g").attr("transform",`translate(0, ${n})`).attr("fill",r).attr("class","mace mace-same").on("click",(e=>{const t=o.select(e.target.parentNode).classed("mace-active");o.selectAll(".mace-same").classed("mace-active",!t)}));m.append("circle").attr("cx",a+t).attr("r",a),m.append("rect").attr("width",t).attr("height",e).attr("y",-e/2),m.append("text").text("Moving in the same direction").style("font-size",10).style("font-weight",600).attr("transform",`translate(${t+2*a+i}, 0)`).attr("alignment-baseline","middle");const p=d.append("g").attr("transform",`translate(0, ${2*n})`).attr("fill",l).attr("class","mace mace-opposite").on("click",(e=>{const t=o.select(e.target.parentNode).classed("mace-active");o.selectAll(".mace-opposite").classed("mace-active",!t)}));p.append("circle").attr("cx",a+t).attr("r",a),p.append("rect").attr("width",t).attr("height",e).attr("y",-e/2),p.append("text").text("Moving in the opposite direction").style("font-size",10).style("font-weight",600).attr("transform",`translate(${t+2*a+i}, 0)`).attr("alignment-baseline","middle");const g=d.node().getBBox();c.attr("height",g.height).attr("width",g.width)}({stickHeight:3,stickLength:30,ballRadius:6,gapForText:5,singleMaceSectionHeight:20,widgetsRight:U,sameDirectionColor:g,oppositeDirectionColor:p}),function({selection:e,circleRadius:t=5,stickLength:a=30,stickWidth:i=2,directionStartLabel:n="start",directionEndLabel:s="end",gapForText:o=5}){const r=e,l=r.append("g"),c=l.append("g").attr("fill","gray");c.append("circle").attr("cx",t+a).attr("r",t),c.append("rect").attr("width",a).attr("height",i).attr("y",-i/2);const d=c.append("text").text(n).attr("alignment-baseline","middle").attr("text-anchor","end").style("font-size",10).attr("transform",`translate(${-o}, 0)`);c.attr("transform",`translate(${d.node().getBBox().width+o}, ${t>d.node().getBBox().height/2?t:d.node().getBBox().height/2})`),c.append("text").text(s).attr("alignment-baseline","middle").attr("text-anchor","start").attr("transform",`translate(${a+2*t+o}, 0)`).style("font-size",10);const m=l.node().getBBox();r.attr("height",m.height).attr("width",m.width)}({selection:U.append("svg"),ballRadius:6,stickLength:30,stickWidthLegend:1,gapForText:5,directionStartLabel:v,directionEndLabel:b}),function({chartCore:e,coreChartHeight:t,coreChartWidth:a,xScale:i,xAxisTickValues:n,xAxisTitle:s}){const r=e.append("g").attr("class","x-axis-bottom").attr("transform",`translate(0, ${t+30})`);r.call(n?o.axisBottom(i).tickValues(n):o.axisBottom(i)),r.append("g").append("text").attr("class","text-xs font-semibold tracking-wider").text(s).attr("fill","#333").attr("text-anchor","middle").attr("transform",`translate(${a/2}, 30)`)}({chartCore:J,coreChartHeight:_,coreChartWidth:q,xScale:te,xAxisTickValues:w,xAxisTitle:y}),function({chartCore:e,coreChartWidth:t,yScale:a,yAxisTitle:i}){const n=e.append("g").attr("class","text-xs y-axis-right").attr("transform",`translate(${t}, 0)`);n.call(o.axisRight(a).ticks(5).tickSize(-t)).call((e=>e.selectAll(".tick line").attr("stroke-opacity",.2))).call((e=>e.select(".domain").remove())),n.append("g").append("text").attr("class","font-semibold tracking-wider").text(i).attr("fill","#333").attr("text-anchor","end").attr("transform","translate(8, -20)")}({chartCore:J,coreChartWidth:q,yScale:ee,yAxisTitle:h}),u({chartCore:J,dataParsed:Z,sizeField:H,nameField:Y,defaultStateAll:oe,xFieldStart:P,xFieldEnd:V,xScale:te,yScale:ee,yFieldStart:W,yFieldEnd:G,circleSizeScale:ae,lineWidthScale:ie,colorScale:ne,tooltipDiv:K,sizeValueFormatter:$,xValueFormatter:f,yValueFormatter:x,xFieldType:I,yFieldType:O});const re=(le=se,e=>{if(e){const t=e.toLowerCase();le.forEach((e=>{const a=d(e);e.toLowerCase().includes(t)?o.select(`.mace-${a}`).classed("mace-matched",!0):o.select(`.mace-${a}`).classed("mace-matched",!1),o.select(".maces").classed("searching",!0)}))}else le.forEach((e=>{const t=d(e);o.select(`.mace-${t}`).classed("mace-matched",!1)})),o.select(".maces").classed("searching",!1)});var le;const ce=function({handleSearch:e,widgetsLeft:t,searchInputClassNames:a,nameField:i}){const n=t.append("input").attr("type","text").attr("class",a);return n.attr("placeholder",`Find by ${i}`),n.on("keyup",(t=>{const a=t.target.value;e(a)})),n}({handleSearch:re,widgetsLeft:Q,searchInputClassNames:N,nameField:Y});!function({widgetsLeft:e,goToInitialStateButtonClassNames:t,defaultStateAll:a,search:i,handleSearch:n}){const s=e.append("button").text("Go to Initial State").attr("class",t);s.classed("hidden",!1),s.on("click",(()=>{o.selectAll(".mace").classed("mace-active",!1),r.default.forEach(a,(e=>{o.select(`.mace-${d(e)}`).classed("mace-active",!0)})),i.node().value="",n("")}))}({widgetsLeft:Q,goToInitialStateButtonClassNames:D,defaultStateAll:oe,search:ce,handleSearch:re}),function({widgetsLeft:e,clearAllButtonClassNames:t,search:a,handleSearch:i}){const n=e.append("button").text("Clear All").attr("class",t);n.classed("hidden",!1),n.on("click",(()=>{o.selectAll(".mace").classed("mace-active",!1),a.node().value="",i("")}))}({widgetsLeft:Q,clearAllButtonClassNames:E,search:ce,handleSearch:re}),m({allComponents:X,svg:M,margins:{marginLeft:s,marginRight:i,marginTop:a,marginBottom:n}})}const f=({data:e,dimensionTypes:t,dimensions:a})=>{const i={};if(r.default.forEach(t,((t,n)=>{r.default.forEach(t,(t=>{const{valid:s,message:o}=t({data:e,dimensions:a,dim:n});if(!s){const e={validation:t.name,status:s,message:o};i[a[n]]?i[a[n]].push(e):i[a[n]]=[e]}}))})),r.default.isEmpty(i))return{valid:!0,message:""};let n="Data Validation Errors </br>";return r.default.mapKeys(i,((e,t)=>{const a=r.default.map(e,(e=>`</br>&nbsp;&nbsp;&nbsp;${e.validation} : row numbers - ${r.default.map(e.message,"rowNumber").join(", ")} | values - ${r.default.map(e.message,t).join(", ")}`)).join("");n+=`${t} : ${a}</br>`})),{valid:!1,message:n}},x=({data:e,dimensions:t,dim:a})=>{const i=r.default.filter(e,((e,i)=>(e.rowNumber=i+1,Number.isNaN(Number(e[t[a]])))));return r.default.isEmpty(i)?{valid:!0,message:""}:{valid:!1,message:i}},v=({data:e,dimensions:t,dim:a})=>{const i=r.default(e).countBy(t[a]).pickBy((e=>e>1)).keys().value(),n=r.default.filter(e,((e,n)=>(e.rowNumber=n+1,r.default.includes(i,e[t[a]]))));return r.default.isEmpty(i)?{valid:!0,message:""}:{valid:!1,message:n}},b=({data:e,dimensions:t,dim:a})=>{const i=r.default.filter(e,((e,i)=>(e.rowNumber=i+1,r.default.isEmpty(e[t[a]]))));return r.default.isEmpty(i)?{valid:!0,message:""}:{valid:!1,message:i}},F=({optionTypes:e,options:t})=>{const a=[];r.default.each(e,((e,i)=>{const n=e(t[i]);n.valid||void 0===t[i]||a.push({keyValue:`${i}: ${t[i]}`,message:n.message})}));const i={valid:!0,message:""};return a.forEach((e=>{e.valid||(i.message+=`&nbsp;&nbsp;&nbsp;${e.keyValue} - ${e.message}<br/>`,i.valid=!1)})),i.message=`Config option validation errors: <br/> ${i.message}`,i},S=e=>t=>e.includes(t)?{valid:!0}:{valid:!1,message:`Should be one of: ${e.join(", ")}`},C=e=>!Number.isNaN(Number(e))?{valid:!0}:{valid:!1,message:"Should be a valid number"},$=e=>t=>{const a=Math.min(...e),i=Math.max(...e),n=`Should be a number between ${a} and ${i}`;if(!C(t).valid)return{valid:!1,message:n};const s=Number(t);return s>=a&&s<=i?{valid:!0}:{valid:!1,message:n}},w=e=>{const t={valid:!0,message:""};if("transparent"===e)return t;const a=o.rgb(e);return r.default.forEach(a,(function(e){t.valid=t.valid&&!r.default.isNaN(e)})),t.valid||(t.message=`Invalid color: ${e}`),t},k=e=>t=>{const a=t.map((e=>w(e))),i={valid:!0,message:""};e&&t.length<e&&(i.valid=!1,i.message=`Need atleast ${e} colors`);const n=[...a,i],s={valid:!0,message:""};return n.forEach((e=>{e.valid||(s.message+=`<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;${e.message}`,s.valid=!1)})),s},L=e=>r.default.isArray(e)&&r.default.reduce(e,((e,t)=>e&&!Number.isNaN(Number(t))),!0)?{valid:!0}:{valid:!1,message:"Should be a valid array of numbers"},z=e=>r.default.isArray(e)||"All"===e?{valid:!0}:{valid:!1,message:'Should be a valid array or "All"'};function B({columns:e,dimensions:t}){if(r.default.isEmpty(t))return{valid:!1,message:"No dimensions provided."};const a={};r.default.each(t,((e,t)=>{r.default.isArray(e)?e.forEach(((e,i)=>{a[`${t}[${i}]`]=e})):a[t]=e}));const i={valid:!0,missingFields:[],message:""};return r.default.each(a,((t,a)=>{const n=r.default.includes(e,t);i.valid=i.valid&&n,n||i.missingFields.push(`{${a}: '${t}'}`)})),i.valid||(i.message=`These dimensions/columns are missing in the data: ${i.missingFields.join(", ")}`),i}function A(e,t){o.select(".config-error-display").remove(),r.default.isEmpty(t)||o.select(e).append("div").attr("class","text-red-500 config-error-display").html(`<p>Errors:</p>\n      <ul class="list-disc"><li>${t.join("</li><li>")}</li></ul>`)}const R={xFieldStart:[x],xFieldEnd:[x],yFieldStart:[x],yFieldEnd:[x],sizeField:[x],nameField:[b,v]},T={containerWidth:S(["max-w-screen-sm","max-w-screen-md","max-w-screen-lg","max-w-screen-xl","max-w-screen-2xl","max-w-full"]),aspectRatio:$([0,Number.POSITIVE_INFINITY]),marginTop:C,marginRight:C,marginBottom:C,marginLeft:C,bgColor:w,xAxisTickValues:L,xScaleType:S(["log","linear"]),xScaleLogBase:C,sizeLegendValues:L,sizeLegendMoveSizeObjectDownBy:C,oppositeDirectionColor:w,sameDirectionColor:w,defaultState:z,activeOpacity:$([0,1]),inactiveOpacity:$([0,1])},N=o;N.sankey=i.sankey,N.sankeyCenter=i.sankeyCenter,N.sankeyLeft=i.sankeyLeft,N.sankeyJustify=i.sankeyJustify,N.sankeyRight=i.sankeyRight;const D={justify:"sankeyJustify",left:"sankeyLeft",right:"sankeyRight",center:"sankeyCenter"};function E({data:e,options:{aspectRatio:t=2,marginTop:a=10,marginRight:i=0,marginBottom:n=10,marginLeft:s=50,bgColor:o="transparent",align:r="justify",verticalGapInNodes:l=10,nodeWidth:c=20,units:d="",format:p="",searchInputClassNames:g=""},dimensions:{sourceField:h,targetField:u,valueField:y},chartContainerSelector:f}){const x=(e,t)=>{const a=N.format(p);return t?`${a(e)} ${t}`:a(e)},v=D[r];N.select("body").append("style").html("\n    .sankey-nodes.hovering g:not(.active) * {\n      opacity: 0.1;\n    }\n    .sankey-links.hovering g:not(.active) {\n      opacity: 0.1;\n    }\n    \n    .sankey-nodes.searching:not(.hovering) g:not(.node-matched) {\n      opacity: 0.1;\n    }\n    .sankey-links.searching:not(.hovering) g:not(.node-matched) > path {\n      opacity: 0.1;\n    }");const b=1e3,F=b/t,S=F+a+n,C=b+s+i,$=N.select(f),w=$.append("div").attr("style","display: flex; justify-content: space-between; padding-bottom: 0.5rem;").append("div").attr("style","display: flex; align-items: end; column-gap: 5px;"),k=$.append("svg").attr("viewBox",`0 0 ${C} ${S}`).style("background",o),L=k.append("g").attr("class","all-components"),z=L.append("g").attr("transform",`translate(${s}, ${a})`),B=N.select("body").append("div").attr("class","dom-tooltip").attr("style","opacity: 0; position: absolute; text-align: center; background-color: white; border-radius: 0.25rem; padding: 0.25rem 0.5rem; font-size: 0.75rem; line-height: 1rem; border-width: 1px;"),A=N.scaleOrdinal(N.schemeCategory10),R=e.map((e=>({source:e[h],target:e[u],value:e[y]}))),T=[...new Set(R.flatMap((e=>[e.source,e.target])))].map((e=>({name:e,category:e.replace(/ .*/,"")}))),E=N.sankey().nodeId((e=>e.name)).nodeAlign(N[v]).nodeWidth(c).nodePadding(l).extent([[0,0],[b,F]])({nodes:T,links:R,units:d}),I=e=>A(void 0===e.category?e.name:e.category);function O(e,t){return e.source&&e.target?P(e,t):V(e,t)}function P(e,t="both"){let a=[e];return"source"!==t&&"both"!==t||(a=[...a,...V(e.source,"source")]),"target"!==t&&"both"!==t||(a=[...a,...V(e.target,"target")]),a}function V(e,t="both"){let a=[e];return"source"!==t&&"both"!==t||e.targetLinks.forEach((function(e){a=[...a,...P(e,t)]})),"target"!==t&&"both"!==t||e.sourceLinks.forEach((function(e){a=[...a,...P(e,t)]})),a}const W=z.append("g").attr("class","sankey-links").attr("fill","none").attr("stroke-opacity",.5).selectAll("g").data(E.links).join("g").attr("class","sankey-link").attr("id",(e=>`iv-link-${e.index}`)).style("mix-blend-mode","multiply").on("mouseover",((e,t)=>{const a=[t];a.forEach((function(e){O(e).forEach((function(e){a.push(e)}))})),N.select(".sankey-nodes").classed("hovering",!0),N.select(".sankey-links").classed("hovering",!0),a.forEach((e=>{e.source&&e.target?N.select(`#iv-link-${e.index}`).classed("active",!0):N.select(`#iv-node-${e.index}`).classed("active",!0)})),B.transition().duration(200).style("opacity",1),B.html(`${t.source.name} → ${t.target.name}<br />${x(t.value,d)} `),B.style("left",`${e.clientX}px`).style("top",`${e.clientY+20+window.scrollY}px`)})).on("mouseout",((e,t)=>{const a=[t];a.forEach((function(e){O(e).forEach((function(e){a.push(e)}))})),N.select(".sankey-nodes").classed("hovering",!1),N.select(".sankey-links").classed("hovering",!1),a.forEach((e=>{e.source&&e.target?N.select(`#iv-link-${e.index}`).classed("active",!1):N.select(`#iv-node-${e.index}`).classed("active",!1)})),B.style("left","-300px").transition().duration(500).style("opacity",0)}));{const e=W.append("linearGradient").attr("id",(e=>`iv-link-gradient-${e.index}`));e.append("stop").attr("offset","0%").attr("stop-color",(e=>I(e.source))),e.append("stop").attr("offset","100%").attr("stop-color",(e=>I(e.target)))}W.append("path").attr("d",N.sankeyLinkHorizontal()).attr("stroke",(e=>`url(#iv-link-gradient-${e.index})`)).attr("stroke-width",(e=>Math.max(1,e.width))).attr("stroke-opacity",.5);const G=z.append("g").attr("class","sankey-nodes").selectAll("g").data(E.nodes).join("g").attr("class","sankey-node").attr("id",(e=>`iv-node-${e.index}`));G.append("rect").attr("x",(e=>e.x0)).attr("y",(e=>e.y0)).attr("height",(e=>e.y1-e.y0)).attr("width",(e=>e.x1-e.x0)).attr("fill",(e=>I(e))).on("mouseover",((e,t)=>{const a=[t];a.forEach((function(e){O(e).forEach((function(e){a.push(e)}))})),N.select(".sankey-nodes").classed("hovering",!0),N.select(".sankey-links").classed("hovering",!0),a.forEach((e=>{e.source&&e.target?N.select(`#iv-link-${e.index}`).classed("active",!0):N.select(`#iv-node-${e.index}`).classed("active",!0)})),B.transition().duration(200).style("opacity",1),B.html(`${t.name}<br />${x(t.value,d)}`),B.style("left",`${e.clientX}px`).style("top",`${e.clientY+20+window.scrollY}px`)})).on("mouseout",((e,t)=>{const a=[t];a.forEach((function(e){O(e).forEach((function(e){a.push(e)}))})),N.select(".sankey-nodes").classed("hovering",!1),N.select(".sankey-links").classed("hovering",!1),a.forEach((e=>{e.source&&e.target?N.select(`#iv-link-${e.index}`).classed("active",!1):N.select(`#iv-node-${e.index}`).classed("active",!1)})),B.style("left","-300px").transition().duration(500).style("opacity",0)})),G.append("text").text((e=>e.name)).attr("font-family","sans-serif").attr("font-size",10).attr("x",(e=>e.x0<500?e.x1+6:e.x0-6)).attr("y",(e=>(e.y1+e.y0)/2)).attr("dy","0.35em").attr("text-anchor",(e=>e.x0<500?"start":"end"));const H=w.append("input").attr("type","text").attr("class",g);H.attr("placeholder","Find by node"),H.on("keyup",(e=>{const t=e.target.value;if(t){N.selectAll(".sankey-link").classed("node-matched",!1),N.selectAll(".sankey-node").classed("node-matched",!1);const e=t.toLowerCase(),a=[];E.nodes.forEach((t=>{const{name:i}=t;i.toLowerCase().includes(e)&&a.push(t)})),a.forEach((function(e){O(e).forEach((function(e){a.find((t=>(t.source&&t.target&&e.source&&e.target||!!(t.sourceLinks&&t.targetLinks&&e.sourceLinks&&e.targetLinks))&&t.index===e.index))||a.push(e)}))})),a.forEach((e=>{e.source&&e.target?N.select(`#iv-link-${e.index}`).classed("node-matched",!0):N.select(`#iv-node-${e.index}`).classed("node-matched",!0)})),N.select(".sankey-nodes").classed("searching",!0),N.select(".sankey-links").classed("searching",!0)}else E.nodes.forEach((e=>{const{index:t}=e;N.select(`#iv-node-${t}`).classed("node-matched",!1)})),N.select(".sankey-nodes").classed("searching",!1),N.select(".sankey-links").classed("searching",!1)})),m({allComponents:L,svg:k,margins:{marginLeft:s,marginRight:i,marginTop:a,marginBottom:n}})}const I={sourceField:[b],targetField:[b],valueField:[x]},O={aspectRatio:$([.01,Number.POSITIVE_INFINITY]),marginTop:C,marginRight:C,marginBottom:C,marginLeft:C,bgColor:w,align:S(["justify","left","right","center"]),verticalGapInNodes:C,nodeWidth:C};function P({color:e,title:t,tickSize:a=6,width:i=320,height:n=44+a,marginTop:s=18,marginRight:r=0,marginBottom:l=16+a,marginLeft:c=0,ticks:d=i/64,removeTicks:m=!1,tickFormat:p,tickValues:g}={}){const h=o.create("svg").attr("width",i).attr("height",n).attr("viewBox",[0,0,i,n]).style("overflow","visible").style("display","block");let u,y=e=>e.selectAll(".tick line").attr("y1",s+l-n);if(e.interpolate){const t=Math.min(e.domain().length,e.range().length);u=e.copy().rangeRound(o.quantize(o.interpolate(c,i-r),t)),h.append("image").attr("x",c).attr("y",s).attr("width",i-c-r).attr("height",n-s-l).attr("preserveAspectRatio","none").attr("xlink:href",V(e.copy().domain(o.quantize(o.interpolate(0,1),t))).toDataURL())}else if(e.interpolator){if(u=Object.assign(e.copy().interpolator(o.interpolateRound(c,i-r)),{range:()=>[c,i-r]}),h.append("image").attr("x",c).attr("y",s).attr("width",i-c-r).attr("height",n-s-l).attr("preserveAspectRatio","none").attr("xlink:href",V(e.interpolator()).toDataURL()),!u.ticks){if(void 0===g){const t=Math.round(d+1);g=o.range(t).map((a=>o.quantile(e.domain(),a/(t-1))))}"function"!=typeof p&&(p=o.format(void 0===p?",f":p))}}else if(e.invertExtent){const t=e.thresholds?e.thresholds():e.quantiles?e.quantiles():e.domain(),a=void 0===p?e=>e:"string"==typeof p?o.format(p):p;u=o.scaleLinear().domain([-1,e.range().length-1]).rangeRound([c,i-r]),h.append("g").selectAll("rect").data(e.range()).join("rect").attr("x",((e,t)=>u(t-1))).attr("y",s).attr("width",((e,t)=>u(t)-u(t-1))).attr("height",n-s-l).attr("fill",(e=>e)),g=o.range(t.length),p=e=>a(t[e],e)}else u=o.scaleBand().domain(e.domain()).rangeRound([c,i-r]),h.append("g").selectAll("rect").data(e.domain()).join("rect").attr("x",u).attr("y",s).attr("width",Math.max(0,u.bandwidth()-1)).attr("height",n-s-l).attr("fill",e),y=()=>{};return h.append("g").attr("transform",`translate(0,${n-l})`).call(o.axisBottom(u).ticks(d,"string"==typeof p?p:void 0).tickFormat("function"==typeof p?p:void 0).tickSize(a).tickValues(g)).call(y).call((e=>e.select(".domain").remove())).call((e=>m?e.selectAll(".tick").remove():null)).call((e=>e.append("text").attr("x",c).attr("y",s+l-n-6).attr("fill","currentColor").attr("text-anchor","start").attr("class","font-sans").attr("style","font-weight: 600;").text(t))),h.node()}function V(e,t=256){var a=document.createElement("canvas");a.width=t,a.height=1;const i=a.getContext("2d");for(let a=0;a<t;++a)i.fillStyle=e(a/(t-1)),i.fillRect(a,0,1,1);return a}function W(e){return`&#${e.charCodeAt(0).toString()};`}function G({data:e,dimensions:{sizeField:t,xField:a,nameField:i,segmentField:n},options:{aspectRatioCombined:s=5,aspectRatioSplit:r=.8,marginTop:c=60,marginRight:d=90,marginBottom:m=20,marginLeft:g=50,bgColor:h="transparent",customColorScheme:u,inbuiltScheme:y="schemeOrRd",numberOfColors:f=5,collisionDistance:x=.5,xDomainCustom:v,xAxisLabel:b=a,xValuePrefix:F="",xValueFormatter:S="",xValueSuffix:C="",sizeRange:$=[2,20],sizeValuePrefix:w="",sizeValueFormatter:k="",sizeValueSuffix:L="",sizeLegendValues:z,sizeLegendTitle:B=t,sizeLegendGapInCircles:A=30,colorLegendTitle:R=a,combinedSegmentLabel:T="All",segmentType:N=n,segmentTypeCombined:D="",segmentTypeSplit:E="",splitButtonClassNames:I="",combinedButtonClassNames:O="",searchInputClassNames:V=""},chartContainerSelector:W}){o.select("body").append("style").html("\n    .g-searching circle.c-match {\n      stroke-width: 2;\n      stroke: #333;\n    }\n    circle.hovered {\n      stroke-width: 2;\n      stroke: #333;\n    }\n  ");const G=1e3,H=G/s,Y=G/r,j=H+c+m,q=Y+c+m,M=G+g+d,_=o.select(W),X=_.append("div").attr("style","display: flex; justify-content: space-between; padding-bottom: 0.5rem;"),J=X.append("div").attr("style","display: flex; align-items: end; column-gap: 5px;"),Q=X.append("div").attr("style","display: flex; align-items: center; column-gap: 10px;"),U=_.append("svg").attr("viewBox",`0 0 ${M} ${j}`).style("background",h),K=U.append("g").attr("class","all-components"),Z=K.append("g").attr("transform",`translate(${g}, ${c})`),ee=o.select("body").append("div").attr("class","dom-tooltip").attr("style","opacity: 0; position: absolute;  background-color: white; border-radius: 0.25rem; padding: 0.25rem 0.5rem; font-size: 0.75rem; line-height: 1rem; border-width: 1px;"),te=e.map((e=>({...e,[t]:Number.parseFloat(e[t]),[a]:Number.parseFloat(e[a])}))),ae=J.append("button").text("Split").attr("class",I),ie=J.append("button").text("Combine").attr("class",O);let ne=!1,se=!1;function oe(){ne?(ae.node().disabled=!1,ae.attr("title",null)):(ae.node().disabled=!0,ae.attr("title","Combined force simulation is either in progress or current configuration is already split")),se?(ie.node().disabled=!1,ie.attr("title",null)):(ie.node().disabled=!0,ie.attr("title","Split force simulation is either in progress or current configuration is already combined"))}oe();const re=[...new Set(te.map((e=>e[n])))],le=Math.max(...te.map((e=>e[t]))),ce=o.scaleSqrt().range($).domain([0,le]),de=o.scalePoint().domain(re).range([0,Y]).padding(.5),me=te.map((e=>e[a])).sort(),pe=o.extent(me),ge=v||pe,he=o.scaleLinear().domain(ge).range([0,G]),ue=o.scaleQuantize().domain(ge).range(u||o[y][f]).nice();Q.append("svg").attr("width",260).attr("height",45).append((()=>P({color:ue,title:R,width:260})));const ye=z.map((e=>ce(e)));let fe=0;const xe=[];ye.forEach(((e,t)=>{fe+=0===t?e:ye[t-1]+ye[t],xe.push(fe)}));const ve=Q.append("svg"),be=ve.append("g");be.append("g").attr("class","g-size-container").attr("transform","translate(0, 5)").selectAll(".g-size-circle").data(ye).enter().append("g").attr("class","g-size-circle").append("circle").attr("r",(e=>e)).style("fill","#bebebe").style("stroke-width",1).style("stroke","gray").attr("cx",((e,t)=>xe[t]+t*A+1)).attr("cy",ye[ye.length-1]+1),be.selectAll(".g-size-circle").append("text").attr("alignment-baseline","middle").attr("dy",ye[ye.length-1]+2).attr("dx",((e,t)=>e+xe[t]+(t+.1)*A)).style("font-size",8).text(((e,t)=>w+l(z[t],k)+L)),be.append("text").attr("alignment-baseline","hanging").style("font-size",10).style("font-weight",600).text(B);const Fe=be.node().getBBox();ve.attr("height",Fe.height).attr("width",Fe.width),Z.append("g").attr("transform","translate(500, -20)").append("text").attr("class","text-xs font-semibold tracking-wider").text(b).attr("text-anchor","middle");const Se=Z.append("g").attr("id","x-axis");const Ce=Z.append("g").attr("transform","translate(-23, -20)").append("text").attr("class","text-xs font-semibold ").text(N).attr("text-anchor","end");const $e=o.scaleBand().domain([T]).range([0,H]);const we=Z.append("g").attr("class","bubbles");let ke;function Le(){const e=we.selectAll("circle").data(te);ke=e.enter().append("circle").attr("r",(e=>ce(e[t]))).style("fill",(function(e){return ue(e[a])})).attr("stroke",(function(e){return o.rgb(ue(e[a])).darker(.5)})).merge(e).attr("cx",(function(e){return e.x})).attr("cy",(function(e){return e.y})).on("mouseover",(function(e,s){ee.transition().duration(200).style("opacity",1),ee.html(`<div><span>${s[i]}</span>(${s[n]})</div>\n         <div style="display: flex">\n           <div style="text-transform: capitalize">${a}:</div>\n           <div style="padding-left: 0.25rem; font-weight: bold">${F+l(s[a],S)+C}</div>\n         </div>\n         <div style="display: flex">\n           <div style="text-transform: capitalize">${t}:</div>\n           <div style="padding-left: 0.25rem; font-weight: bold">${w+l(s[t],k)+L}</div>\n         </div>`),ee.style("left",`${e.clientX}px`).style("top",`${e.clientY+window.scrollY+30}px`),o.select(this).classed("hovered",!0)})).on("mouseout",(function(){ee.transition().duration(500).style("opacity",0),o.select(this).classed("hovered",!1)})),e.exit().remove(),p({allComponents:K,svg:U,margins:{marginLeft:g,marginRight:d,marginTop:c,marginBottom:m}})}const ze=J.append("input").attr("type","text").attr("class",V);function Be(){se=!1,oe(),Se.call(o.axisTop(he).tickSize(-H).tickFormat((e=>F+l(e,S)+C))).call((e=>e.selectAll(".tick line").attr("stroke-opacity",.1))).call((e=>e.select(".domain").remove())),o.select("#y-axis-split").remove(),Z.append("g").attr("id","y-axis-combined").call(o.axisLeft($e).tickSize(-1e3)).call((e=>e.select(".domain").remove())).call((e=>{e.selectAll(".tick line").attr("stroke-opacity",.1),e.selectAll(".tick text").attr("transform","translate(-20,0)").classed("text-xs",!0)})).attr("opacity",0).transition().duration(1e3).attr("opacity",1),Ce.text(D),U.attr("viewBox",`0 0 ${M} ${j}`),we.attr("transform",`translate(0, ${H/2})`),we.raise(),o.forceSimulation(te).force("charge",o.forceManyBody().strength(1)).force("x",o.forceX().x((e=>he(e[a]))).strength(1)).force("y",o.forceY().y(0)).force("collision",o.forceCollide().radius((function(e){return ce(e[t])+x}))).on("tick",Le).on("end",(()=>{console.log("combined force simulation ended"),ne=!0,oe()}))}ze.attr("placeholder",`Find by ${i}`),ze.on("keyup",(e=>{var t;(t=e.target.value.trim())?(o.select(".bubbles").classed("g-searching",!0),ke.classed("c-match",(e=>e[i].toLowerCase().includes(t.toLowerCase())))):o.select(".bubbles").classed("g-searching",!1)})),ae.on("click",(function(){ne=!1,oe(),Se.call(o.axisTop(he).tickSize(-Y).tickFormat((e=>F+l(e,S)+C))).call((e=>e.selectAll(".tick line").attr("stroke-opacity",.1))).call((e=>e.select(".domain").remove())),o.select("#y-axis-combined").remove(),Z.append("g").attr("id","y-axis-split").call(o.axisLeft(de).tickSize(-1e3)).call((e=>e.select(".domain").remove())).call((e=>{e.selectAll(".tick line").attr("stroke-opacity",.1),e.selectAll(".tick text").attr("transform","translate(-20,0)").classed("text-xs",!0)})).attr("opacity",0).transition().duration(1e3).attr("opacity",1),Ce.text(E),U.attr("viewBox",`0 0 ${M} ${q}`),we.attr("transform","translate(0, 0)"),we.raise(),o.forceSimulation(te).force("charge",o.forceManyBody().strength(1)).force("x",o.forceX().x((function(e){return he(e[a])})).strength(1)).force("y",o.forceY().y((function(e){return de(e[n])})).strength(1.2)).force("collision",o.forceCollide().radius((function(e){return ce(e[t])+x}))).on("tick",Le).on("end",(()=>{console.log("split force simulation ended"),se=!0,oe()}))})),ie.on("click",Be),Be()}const H=["schemeBrBG","schemePRGn","schemePiYG","schemePuOr","schemeRdBu","schemeRdGy","schemeRdYlBu","schemeRdYlGn","schemeSpectral","schemeBuGn","schemeBuPu","schemeGnBu","schemeOrRd","schemePuBuGn","schemePuBu","schemePuRd","schemeRdPu","schemeYlGnBu","schemeYlGn","schemeYlOrBr","schemeYlOrRd","schemeBlues","schemeGreens","schemeGreys","schemePurples","schemeReds","schemeOranges"],Y={sizeField:[x],xField:[x],nameField:[b],segmentField:[b]},j={aspectRatioCombined:$([.01,Number.MAX_SAFE_INTEGER]),aspectRatioSplit:$([.01,Number.MAX_SAFE_INTEGER]),marginTop:C,marginRight:C,marginBottom:C,marginLeft:C,bgColor:w,customColorScheme:k,inbuiltScheme:S(H),numberOfColors:$([3,9]),collisionDistance:$([0,Number.MAX_SAFE_INTEGER]),xDomainCustom:L,sizeRange:L,sizeLegendValues:L,sizeLegendGapInCircles:C};function q({data:e,options:{aspectRatio:t=2,marginTop:a=60,marginRight:i=90,marginBottom:n=20,marginLeft:s=50,bgColor:l="transparent",xPaddingOuter:c=.2,xAxisLabel:p=$,dominoSize:g=.2,yPaddingInner:h=.2,yPaddingOuter:u=.2,ySortOrder:y="desc",colorStrategy:f="value",colorThreshold:x=10,colorDominoHighlighted:v="#c20a66",colorDominoNormal:b="#d9e2e4",normalLegendLabel:F="Normal",highlightedLegendLabel:S="Highlighted",searchInputClassNames:C=""},dimensions:{xField:$,yField:w,dominoField:k,colorField:L},chartContainerSelector:z}){o.select("body").append("style").html("\n  rect.domino.domino-hovered {\n    stroke: #333;\n  }\n  g.dominos.searching g rect.domino-matched {\n    stroke: #333;\n  }\n  ");const B=1e3,{svg:A,coreChartHeight:R,allComponents:T,chartCore:N,widgetsLeft:D,widgetsRight:E}=function({chartContainerSelector:e,coreChartWidth:t,aspectRatio:a,marginTop:i,marginBottom:n,marginLeft:s,marginRight:r,bgColor:l}){const c=t/a,d=c+i+n,m=t+s+r,p=o.select(e),g=p.append("div").attr("style","display: flex; justify-content: space-between; padding-bottom: 0.5rem;"),h=g.append("div").attr("style","display: flex; align-items: end; column-gap: 5px;"),u=g.append("div").attr("style","display: flex; align-items: center; column-gap: 10px;"),y=p.append("svg").attr("viewBox",`0 0 ${m} ${d}`).style("background",l),f=y.append("g").attr("class","all-components"),x=f.append("g").attr("transform",`translate(${s}, ${i})`);return{svg:y,coreChartHeight:c,allComponents:f,chartCore:x,widgetsLeft:h,widgetsRight:u}}({chartContainerSelector:z,coreChartWidth:B,aspectRatio:t,marginTop:a,marginBottom:n,marginLeft:s,marginRight:i,bgColor:l}),I=o.select("body").append("div").attr("class","dom-tooltip").attr("style","opacity: 0; position: absolute; text-align: center; background-color: white; border-radius: 0.25rem; padding: 0.25rem 0.5rem; font-size: 0.75rem; line-height: 1rem; border-width: 1px;"),O=function({data:e,colorField:t,yField:a}){let i=e.map((e=>{const a={...e};return a[t]=Number.parseFloat(e[t]),a}));return i=r.default(i).groupBy(a).map((e=>{e.forEach(((e,t)=>{e.__idx__=t}));const a=r.default.orderBy(e,t,"desc");return a.forEach(((e,t)=>{e.__rank__=t})),r.default.orderBy(a,"__idx__","asc")})).value().flat(),i}({data:e,colorField:L,yField:w}),{xScale:P,yScale:V,colorScale:W}=function({dataParsed:e,xField:t,yField:a,dominoSize:i,coreChartWidth:n,coreChartHeight:s,xPaddingOuter:l,ySortOrder:c,yPaddingOuter:d,yPaddingInner:m,colorStrategy:p,colorThreshold:g,colorDominoNormal:h,colorDominoHighlighted:u}){const y=r.default(e).map(t).uniq().value(),f=1-i,x=o.scaleBand().domain(y).range([0,n]).paddingInner(f).paddingOuter(l),v=r.default(e).orderBy([a],[c]).map(a).uniq().value();return{xScale:x,yScale:o.scaleBand().domain(v).range([0,s]).paddingInner(m).paddingOuter(d),colorScale:"value"===p?e=>e>=g?u:h:e=>e>=g?h:u}}({dataParsed:O,xField:$,yField:w,dominoSize:g,coreChartWidth:B,coreChartHeight:R,xPaddingOuter:c,ySortOrder:y,yPaddingOuter:u,yPaddingInner:h,colorThreshold:x,colorDominoNormal:b,colorDominoHighlighted:v,colorStrategy:f});!function({chartCore:e,yScale:t}){e.append("g").attr("class","y-axis-left").call(o.axisLeft(t).tickSize(0)).call((e=>e.select(".domain").remove()))}({chartCore:N,yScale:V}),function({dataParsed:e,yField:t,chartCore:a,yScale:i,dominoField:n,xScale:s,xField:r,colorScale:l,colorField:c,colorStrategy:m,tooltipDiv:p}){const g=o.groups(e,(e=>e[t])).map((([e,a])=>({[t]:e,values:a})));a.append("g").attr("class","dominos").selectAll("g").data(g).join("g").attr("id",(e=>`${t}-${e[t]}`)).attr("transform",(e=>`translate(0, ${i(e[t])})`)).selectAll("rect").data((e=>e.values)).join("rect").attr("class",(e=>`domino domino-${d(e[n])}`)).attr("width",s.bandwidth()).attr("height",i.bandwidth()).attr("x",(e=>s(e[r]))).attr("y",0).attr("fill",(e=>l("value"===m?e[c]:e.__rank__))).on("mouseover",((e,t)=>{o.select(e.target).classed("domino-hovered",!0),p.transition().duration(200).style("opacity",1),p.html(`${t[n]}, Pick # ${t[r]}`),p.style("left",`${e.clientX}px`).style("top",`${e.clientY+20+window.scrollY}px`)})).on("mouseout",(e=>{o.select(e.target).classed("domino-hovered",!1),p.style("left","-300px").transition().duration(500).style("opacity",0)}))}({dataParsed:O,yField:w,chartCore:N,yScale:V,dominoField:k,xScale:P,xField:$,colorScale:W,colorField:L,colorStrategy:f,tooltipDiv:I}),function({chartCore:e,xAxisLabel:t,coreChartWidth:a}){e.append("text").text(t).attr("transform",`translate(${a/2}, 0)`).attr("text-anchor","middle").attr("font-size",12)}({chartCore:N,xAxisLabel:p,coreChartWidth:B});const G=r.default(O).map(k).uniq().value();var H;!function({handleSearch:e,widgetsLeft:t,searchInputClassNames:a,dominoField:i}){const n=t.append("input").attr("type","text").attr("class",a);n.attr("placeholder",`Find by ${i}`),n.on("keyup",(t=>{const a=t.target.value;e(a)}))}({handleSearch:(H=G,e=>{if(e){const t=e.toLowerCase();H.forEach((e=>{const a=d(e);e.toLowerCase().includes(t)?o.select(`.domino-${a}`).classed("domino-matched",!0):o.select(`.domino-${a}`).classed("domino-matched",!1),o.select(".dominos").classed("searching",!0)}))}else H.forEach((e=>{const t=d(e);o.select(`.domino-${t}`).classed("domino-matched",!1)})),o.select(".dominos").classed("searching",!1)}),widgetsLeft:D,searchInputClassNames:C,dominoField:k}),function({xScale:e,yScale:t,widgetsRight:a,colorDominoHighlighted:i,highlightedLegendLabel:n,colorDominoNormal:s,normalLegendLabel:o}){const r=a.append("svg"),l=r.append("g"),c=e.bandwidth(),d=t.bandwidth(),m=l.append("g");m.append("rect").attr("x",0).attr("y",0).attr("width",c).attr("height",d).attr("fill",i),m.append("text").attr("x",c+5).attr("y",d/2).attr("font-size",12).attr("dominant-baseline","middle").text(n);const p=m.node().getBBox().width,g=l.append("g").attr("transform",`translate(${p+20}, 0)`);g.append("rect").attr("x",0).attr("y",0).attr("width",c).attr("height",d).attr("fill",s),g.append("text").attr("x",c+5).attr("y",d/2).attr("font-size",12).attr("dominant-baseline","middle").text(o);const h=l.node().getBBox();r.attr("width",h.width).attr("height",h.height)}({xScale:P,yScale:V,widgetsRight:E,colorDominoHighlighted:v,highlightedLegendLabel:S,colorDominoNormal:b,normalLegendLabel:F}),m({allComponents:T,svg:A,margins:{marginLeft:s,marginRight:i,marginTop:a,marginBottom:n}})}const M={xField:[b],yField:[b],colorField:[x],dominoField:[b]},_={aspectRatio:$([0,Number.POSITIVE_INFINITY]),marginTop:C,marginRight:C,marginBottom:C,marginLeft:C,bgColor:w,xPaddingOuter:$([0,1]),yPaddingInner:$([0,1]),yPaddingOuter:$([0,1]),ySortOrder:S(["asc","desc"]),colorStrategy:S(["rank","value"]),colorThreshold:C,colorDominoHighlighted:w,colorDominoNormal:w,dominoSize:$([0,1])};const X=(e,t)=>o.timeParse(t)(e);function J({data:e,options:{aspectRatio:t=.8,marginTop:a=0,marginRight:i=0,marginBottom:n=0,marginLeft:s=0,bgColor:c="#eee",xAxisTitle:p="",xAxisDateParser:g="",xAxisDateFormatter:h="",xTooltipFormatter:u="%B %d, %Y",overlap:y=1,yValueFormatter:f="",yValuePrefix:x="",yValuePostfix:v="",seriesLabelPosition:b="left",colorRange:F=o.schemeTableau10,defaultState:S=[],activeOpacity:C=.8,inactiveOpacity:$=.2,searchInputClassNames:w="",goToInitialStateButtonClassNames:k="",clearAllButtonClassNames:L="",showAllButtonClassNames:z=""},dimensions:{seriesField:B,xField:A,yField:R,colorField:T},chartContainerSelector:N}){!function({activeOpacity:e,inactiveOpacity:t}){o.select("body").append("style").html(`\ng.serieses .series {\n  fill-opacity: ${t};\n}\n/* clicked and legend clicked states are common: controlled by .mace-active */\ng.serieses .series.series-active {\n  fill-opacity: ${e};\n}\ng.serieses.searching .series.series-matched .top-line {\n  fill-opacity: ${e};\n  stroke: #000;\n  stroke-width: 3;\n}\n/* So that legend text is visible irrespective of state */\ng.series text {\n  fill-opacity: ${e};\n}\ng.serieses g.series.series-matched text {\n  font-weight: bolder;\n}\ng.serieses g.series.series-hovered .top-line {\n  stroke-width: 3;\n}\ng.circles circle.circle {\n  r: 2;\n  fill-opacity: 0.1;\n}\ng.circles circle.circle.circle-hovered {\n  r: 5;\n  fill-opacity: ${e};\n}\n`)}({activeOpacity:C,inactiveOpacity:$});const D=1e3,{svg:E,coreChartHeight:I,allComponents:O,chartCore:P,widgetsLeft:V,viewBoxWidth:W}=function({chartContainerSelector:e,coreChartWidth:t,aspectRatio:a,marginTop:i,marginBottom:n,marginLeft:s,marginRight:r,bgColor:l}){const c=t/a,d=c+i+n,m=t+s+r,p=o.select(e),g=p.append("div").attr("style","display: flex; justify-content: space-between; padding-bottom: 0.5rem;"),h=g.append("div").attr("style","display: flex; align-items: end; column-gap: 5px;"),u=g.append("div").attr("style","display: flex; align-items: center; column-gap: 10px;"),y=p.append("svg").attr("viewBox",`0 0 ${m} ${d}`).style("background",l),f=y.append("g").attr("class","all-components"),x=f.append("g").attr("transform",`translate(${s}, ${i})`);return{svg:y,coreChartHeight:c,allComponents:f,chartCore:x,widgetsLeft:h,widgetsRight:u,viewBoxWidth:m}}({chartContainerSelector:N,coreChartWidth:D,aspectRatio:t,marginTop:a,marginBottom:n,marginLeft:s,marginRight:i,bgColor:c}),G=o.select("body").append("div").attr("class","dom-tooltip").attr("style","opacity: 0; position: absolute; text-align: center; background-color: white; border-radius: 0.25rem; padding: 0.25rem 0.5rem; font-size: 0.75rem; line-height: 1rem; border-width: 1px;"),{parsedData:H,nestedData:Y}=function({data:e,yField:t,xField:a,seriesField:i,colorField:n}){const s=e.map((e=>({...e,[t]:Number.parseFloat(e[t])})));return s.sort(((e,t)=>e[a]-t[a])),{parsedData:s,nestedData:o.groups(s,(e=>e[i])).map((([e,t])=>({[i]:e,values:t,[n]:t[0][n]})))}}({data:e,yField:R,xField:A,seriesField:B,colorField:T}),{yScale:j,xScale:q,categoryScale:M,categoryDomain:_,fillColorScale:J}=function({parsedData:e,nestedData:t,xField:a,yField:i,seriesField:n,coreChartWidth:s,coreChartHeight:l,overlap:c,xAxisDateParser:d,colorField:m,colorRange:p}){const g=o.extent(r.default.chain(e).map(a).uniq().value().map((e=>X(e,d)))),h=o.scaleTime([0,s]).domain(g),u=t.map((e=>e[n])),y=o.scaleBand().range([0,l]).domain(u).paddingInner(0).paddingOuter(0),f=o.extent(e,(e=>e[i])),x=o.scaleLinear().range([0,-(1+c)*y.step()]).domain(f),v=r.default.chain(e).map(m).uniq().value();return{yScale:x,xScale:h,categoryScale:y,categoryDomain:u,fillColorScale:o.scaleOrdinal().range(p).domain(v)}}({parsedData:H,nestedData:Y,xField:A,yField:R,seriesField:B,coreChartWidth:D,coreChartHeight:I,overlap:y,xAxisDateParser:g,colorField:T,colorRange:F}),Q="All"===S?_:S;!function({chartCore:e,coreChartHeight:t,xScale:a,xAxisDateFormatter:i,xAxisTitle:n,coreChartWidth:s}){const r=e.append("g").attr("class","x-axis-bottom").attr("transform",`translate(0, ${t+10})`);r.call(o.axisBottom(a).tickFormat((e=>o.timeFormat(i)(e)))),r.append("g").append("text").attr("class","text-xs font-semibold tracking-wider").text(n).attr("fill","#333").attr("text-anchor","middle").attr("transform",`translate(${s/2}, 30)`)}({chartCore:P,coreChartHeight:I,xScale:q,xAxisDateFormatter:h,xAxisTitle:p,coreChartWidth:D}),function({chartCore:e,nestedData:t,seriesField:a,defaultStateAll:i,categoryScale:n,xField:s,yField:r,xAxisDateParser:c,xScale:m,yScale:p,fillColorScale:g,colorField:h,tooltipDiv:u,xTooltipFormatter:y,yValuePrefix:f,yValuePostfix:x,yValueFormatter:v,seriesLabelPosition:b,viewBoxWidth:F}){const S=e.append("g").attr("class","serieses").selectAll(".series").data(t).join("g").attr("class",(e=>`series \n    series-${d(e[a])} \n    ${i.includes(e[a])?"series-active":""}`)).attr("transform",(e=>`translate(0, ${n(e[a])+n.bandwidth()})`)).on("click",(e=>{const t=o.select(e.target.parentNode),a=t.classed("series-active");t.classed("series-active",!a)})).on("mouseover",(e=>{o.select(e.target.parentNode).classed("series-hovered",!0)})).on("mouseout",(e=>{o.select(e.target.parentNode).classed("series-hovered",!1)})),C=o.area().x((e=>m(X(e[s],c)))).y1((e=>p(e[r]))).y0(p(0));S.append("path").attr("fill",(e=>o.rgb(g(e[h])).brighter(.2))).datum((e=>e.values)).attr("d",C).attr("stroke",(e=>o.rgb(g(e[0][h])).darker(.5))),S.append("path").attr("class","top-line").attr("fill","none").datum((e=>e.values)).attr("d",C.lineY1()),S.append("g").attr("class","circles").selectAll(".circle").data((e=>e.values)).join("circle").attr("class","circle").attr("cx",(e=>m(X(e[s],c)))).attr("cy",(e=>p(e[r]))).attr("fill",(e=>o.rgb(g(e[h])).darker(1))).on("mouseover",((e,t)=>{o.select(e.target).classed("circle-hovered",!0),u.transition().duration(200).style("opacity",1),u.html(`${a}: ${t[a]} (${o.timeFormat(y)(o.timeParse(c)(t[s]))})\n      <br/>\n      ${r}: ${f+l(t[r],v)+x}\n      `),u.style("left",`${e.clientX}px`).style("top",`${e.clientY+20+window.scrollY}px`)})).on("mouseout",(e=>{o.select(e.target).classed("circle-hovered",!1),u.style("left","-300px").transition().duration(500).style("opacity",0)})),S.append("text").text((e=>e[a])).attr("text-anchor","right"===b?"start":"end").attr("transform",`translate(${"right"===b?F+5:-5}, 0)`).style("font-size",10)}({chartCore:P,nestedData:Y,seriesField:B,defaultStateAll:Q,categoryScale:M,xField:A,yField:R,xAxisDateParser:g,xScale:q,yScale:j,fillColorScale:J,colorField:T,tooltipDiv:G,xTooltipFormatter:u,yValuePrefix:x,yValuePostfix:v,yValueFormatter:f,seriesLabelPosition:b,viewBoxWidth:W});const U=(K=_,e=>{if(e){const t=d(e).toLowerCase();K.forEach((e=>{const a=d(e);a.toLowerCase().includes(t)?o.select(`.series-${a}`).classed("series-matched",!0):o.select(`.series-${a}`).classed("series-matched",!1),o.select(".serieses").classed("searching",!0)}))}else K.forEach((e=>{const t=d(e);o.select(`.series-${t}`).classed("series-matched",!1)})),o.select(".serieses").classed("searching",!1)});var K;const Z=function({handleSearch:e,widgetsLeft:t,searchInputClassNames:a,seriesField:i}){const n=t.append("input").attr("type","text").attr("class",a);return n.attr("placeholder",`Find by ${i}`),n.on("keyup",(t=>{const a=t.target.value;e(a)})),n}({handleSearch:U,widgetsLeft:V,searchInputClassNames:w,seriesField:B});!function({widgetsLeft:e,goToInitialStateButtonClassNames:t,defaultStateAll:a,search:i,handleSearch:n}){const s=e.append("button").text("Go to Initial State").attr("class",t);s.classed("hidden",!1),s.on("click",(()=>{o.selectAll(".series").classed("series-active",!1),r.default.forEach(a,(e=>{o.select(`.series-${d(e)}`).classed("series-active",!0)})),i.node().value="",n("")}))}({widgetsLeft:V,goToInitialStateButtonClassNames:k,defaultStateAll:Q,search:Z,handleSearch:U}),function({widgetsLeft:e,clearAllButtonClassNames:t,search:a,handleSearch:i}){const n=e.append("button").text("Clear All").attr("class",t);n.classed("hidden",!1),n.on("click",(()=>{o.selectAll(".series").classed("series-active",!1),a.node().value="",i("")}))}({widgetsLeft:V,clearAllButtonClassNames:L,search:Z,handleSearch:U}),function({widgetsLeft:e,showAllButtonClassNames:t,search:a,handleSearch:i}){const n=e.append("button").text("Show All").attr("class",t);n.classed("hidden",!1),n.on("click",(()=>{o.selectAll(".series").classed("series-active",!0),a.node().value="",i("")}))}({widgetsLeft:V,showAllButtonClassNames:z,search:Z,handleSearch:U}),m({allComponents:O,svg:E,margins:{marginLeft:s,marginRight:i,marginTop:a,marginBottom:n}})}const Q={xField:[b],yField:[x],seriesField:[b],colorField:[b]},U={aspectRatio:$([.01,Number.POSITIVE_INFINITY]),marginTop:C,marginRight:C,marginBottom:C,marginLeft:C,bgColor:w,seriesLabelPosition:S(["left","right"]),overlap:C,colorRange:k(),defaultState:z,activeOpacity:$([0,1]),inactiveOpacity:$([0,1])};function K({widgetsRight:e,colorScaleForLegend:t}){e.html(function({color:e,columns:t=null,format:a=(e=>e),swatchSize:i=15,swatchWidth:n=i,swatchHeight:s=i,marginLeft:o=0,uid:r,customClass:l=""}){const c=r;return null!==t?`<div\n      style="display: flex; align-items: center; margin-left: ${+o}px; min-height: 33px; font: 10px sans-serif;"\n    >\n      <style>\n        .${c}-item {\n          break-inside: avoid;\n          display: flex;\n          align-items: center;\n          padding-bottom: 1px;\n        }\n\n        .${c}-label {\n          white-space: nowrap;\n          overflow: hidden;\n          text-overflow: ellipsis;\n          color: red;\n          max-width: calc(100% - ${+n}px - 0.5em);\n        }\n\n        .${c}-swatch {\n          width: ${+n}px;\n          height: ${+s}px;\n          margin: 0 0.5em 0 0;\n        }\n      </style>\n      <div style="width: 100%; columns: ${t};">\n        ${e.domain().map((t=>{const i=a(t);return`<div class="${c}-item">\n            <div class="${c}-swatch" style="background:${e(t)};"></div>\n            <div class="${l} ${c}-label" title="${i.replace(/["&]/g,W)}">\n              ${document.createTextNode(i)}\n            </div>\n          </div>`}))}\n      </div>\n    </div>`:`<div\n    style="display: flex; align-items: center; min-height: 33px; margin-left: ${+o}px; font: 10px sans-serif;"\n  >\n    <style>\n      .${c} {\n        display: inline-flex;\n        align-items: center;\n        margin-right: 1em;\n      }\n\n      .${c}::before {\n        content: "";\n        width: ${+n}px;\n        height: ${+s}px;\n        margin-right: 0.5em;\n        background: var(--color);\n      }\n    </style>\n    <div>\n      ${e.domain().map((t=>`<span class="${l} ${c}" style="--color: ${e(t)}"\n              >${a(t)}</span\n            >`)).join("")}\n    </div>\n  </div>`}({color:t,uid:"rs",customClass:""}))}function Z({data:e,options:{aspectRatio:t=.8,marginTop:a=0,marginRight:i=0,marginBottom:n=0,marginLeft:s=0,bgColor:l="#fafafa",colorScheme:c=o.schemeRdYlGn[F.length],descending:d=!0,yFieldLabels:p=F,uniqueFieldTimeParser:g="%Y%m",uniqueFieldTimeFormatter:h="%b %Y",xGridGap:u=.02,stackHeight:y=.5},dimensions:{xGridField:f,yGridField:x,xField:v,nameField:b,yFields:F,uniqueColumnField:S},chartContainerSelector:C}){const{svg:$,coreChartHeight:w,allComponents:k,chartCore:L,widgetsRight:z}=function({chartContainerSelector:e,coreChartWidth:t,aspectRatio:a,marginTop:i,marginBottom:n,marginLeft:s,marginRight:r,bgColor:l}){const c=t/a,d=c+i+n,m=t+s+r,p=o.select(e),g=p.append("div").attr("style","display: flex; justify-content: space-between; padding-bottom: 0.5rem;"),h=g.append("div").attr("style","display: flex; align-items: end; column-gap: 5px;"),u=g.append("div").attr("style","display: flex; align-items: center; column-gap: 10px;"),y=p.append("svg").attr("viewBox",`0 0 ${m} ${d}`).style("background",l),f=y.append("g").attr("class","all-components"),x=f.append("g").attr("transform",`translate(${s}, ${i})`);return{svg:y,coreChartHeight:c,allComponents:f,chartCore:x,widgetsLeft:h,widgetsRight:u,viewBoxWidth:m}}({chartContainerSelector:C,coreChartWidth:1e3,aspectRatio:t,marginTop:a,marginBottom:n,marginLeft:s,marginRight:i,bgColor:l}),B=o.select("body").append("div").attr("class","dom-tooltip").attr("style","opacity: 0; position: absolute; background-color: white; border-radius: 0.25rem; padding: 0.25rem 0.5rem; font-size: 0.75rem; line-height: 1rem; border-width: 1px;"),{maxY:A,stackedDataByYear:R,names:T}=function({data:e,yFields:t,nameField:a,xGridField:i,yGridField:n}){let s=0;e.forEach((e=>{let a=0;t.forEach((t=>{a+=Number.parseFloat(e[t])})),a>s&&(s=a)}));const l=s,c={};e.forEach((e=>{const t=e[a];c[t]?c[t].push(e):c[t]=[e]}));const d={};Object.keys(c).forEach((e=>{d[e]=o.stack().keys(t)(c[e])}));const m=r.default.uniqBy(e.map((e=>({[a]:e[a],[i]:e[i],[n]:e[n]}))),a);return{maxY:l,stackedDataByYear:d,names:m}}({data:e,yFields:F,nameField:b,xGridField:f,yGridField:x}),{yScale:N,xScale:D,colorScale:E,colorScaleForLegend:I,xGridScale:O,yGridScale:P}=function({data:e,maxY:t,xGridField:a,xGridGap:i,yGridField:n,descending:s,stackHeight:l,xField:c,colorScheme:d,yFields:m,yFieldLabels:p,coreChartWidth:g,coreChartHeight:h}){const u=[0,t],y=r.default.uniq(e.map((e=>e[a]))).sort(),f=o.scaleBand().domain(y).range([0,g]).paddingInner(i),x=r.default.uniq(e.map((e=>e[c]))).sort(),v=o.scaleBand().domain(x).range([0,f.bandwidth()]),b=r.default.uniq(e.map((e=>e[n]))),F=[0,h],S=o.scaleBand().domain(b).range(s?F.reverse():F).paddingInner(1-l);return{yScale:o.scaleLinear().domain(u).range([S.bandwidth(),0]),xScale:v,colorScale:o.scaleOrdinal(d).domain(m),colorScaleForLegend:o.scaleOrdinal(d).domain(p),xGridScale:f,yGridScale:S}}({data:e,maxY:A,xGridField:f,xGridGap:u,yGridField:x,descending:d,stackHeight:y,xField:v,colorScheme:c,yFields:F,yFieldLabels:p,coreChartWidth:1e3,coreChartHeight:w});!function({chartCore:e,names:t,xField:a,xGridScale:i,yGridScale:n,xGridField:s,yGridField:r,tooltipDiv:l,stackedDataByYear:c,nameField:d,colorScale:m,xScale:p,yScale:g,uniqueFieldTimeFormatter:h,uniqueFieldTimeParser:u,uniqueColumnField:y,yFields:f,yFieldLabels:x}){e.selectAll("g.cell").data(t).join("g").attr("transform",(e=>`translate(\n          ${i(e[s])},\n          ${n(e[r])}\n        )`)).each((function(e){o.select(this).selectAll("g").data(c[e[d]]).enter().append("g").attr("fill",(e=>m(e.key))).selectAll("rect").data((e=>e)).join("rect").attr("x",(e=>p(e.data[a]))).attr("y",(e=>g(e[1]))).attr("height",(e=>g(e[0])-g(e[1]))).attr("width",p.bandwidth()).on("mouseover",(function(e,t){o.select(this.parentNode).raise(),o.select(this).classed("rect-hovered",!0).raise(),l.transition().duration(200).style("opacity",1);const a=o.timeFormat(h)(o.timeParse(u)(t.data[y]))||t.data[y],i=f.map(((e,a)=>`<div style="display: inline-block; height: 0.5rem; width: 0.5rem; background: ${m(e)}"></div> ${x[a]}: ${o.format(".1%")(t.data[e])}`)).reverse();l.html(`<b>${a}</b> <br/> ${i.join("<br/>")}`),l.style("left",`${e.clientX}px`).style("top",`${e.clientY+20+window.scrollY}px`)})).on("mouseout",(function(){o.select(this).classed("rect-hovered",!1),l.style("left","-300px").transition().duration(500).style("opacity",0)}))})).append("text").text((e=>e[d])).attr("transform","translate(0, -5)").attr("font-size",14)}({chartCore:L,names:T,xField:v,xGridScale:O,yGridScale:P,xGridField:f,yGridField:x,tooltipDiv:B,stackedDataByYear:R,nameField:b,colorScale:E,xScale:D,yScale:N,uniqueFieldTimeFormatter:h,uniqueFieldTimeParser:g,uniqueColumnField:S,yFields:F,yFieldLabels:p}),K({widgetsRight:z,colorScaleForLegend:I}),m({allComponents:k,svg:$,margins:{marginLeft:s,marginRight:i,marginTop:a,marginBottom:n}})}const ee={xGridField:[b],yGridField:[b],xField:[b],nameField:[b],uniqueColumnField:[v]},te={aspectRatio:$([.01,Number.POSITIVE_INFINITY]),marginTop:C,marginRight:C,marginBottom:C,marginLeft:C,bgColor:w,descending:e=>"boolean"==typeof e?{valid:!0}:{valid:!1,message:"Should be true or false"},stackHeight:$([0,1]),xGridGap:$([0,1])};function ae({data:e,dimensions:{sizeField:t,xField:a,yField:i,timeField:n,nameField:s,colorField:c},options:{motionDelay:p=1e3,marginTop:g=40,marginRight:h=50,marginBottom:u=50,marginLeft:y=40,bgColor:f="transparent",aspectRatio:x=2,sizeRange:v=[2,20],sizeValueFormat:b="",xDomainCustom:F=null,xAxisLabel:S=a,xValueFormat:C="",yDomainCustom:$=null,yAxisLabel:w=i,yValueFormat:k="",inbuiltScheme:L="schemePuRd",numberOfColors:z=9,inactiveOpacity:B=.1,activeOpacity:A=1,startButtonClassNames:R="",stopButtonClassNames:T="",searchButtonClassNames:N=""},chartContainerSelector:D}){!function({inactiveOpacity:e}){o.select("body").append("style").html(`\n  .group-circles.searching > .iv-circle:not(.s-match) {\n    opacity: ${e};\n  }\n  .group-circles.searching > .iv-circle.s-match {\n    stroke: #333;\n  }\n  `)}({inactiveOpacity:B});const E=1e3,{svg:I,coreChartHeight:O,allComponents:P,chartCore:V,widgetsLeft:W}=function({chartContainerSelector:e,coreChartWidth:t,aspectRatio:a,marginTop:i,marginBottom:n,marginLeft:s,marginRight:r,bgColor:l}){const c=t/a,d=c+i+n,m=t+s+r,p=o.select(e),g=p.append("div").attr("style","display: flex; justify-content: space-between; padding-bottom: 0.5rem;"),h=g.append("div").attr("style","display: flex; align-items: center; column-gap: 5px;"),u=g.append("div").attr("style","display: flex; align-items: center; column-gap: 10px;"),y=p.append("svg").attr("viewBox",`0 0 ${m} ${d}`).style("background",l),f=y.append("g").attr("class","all-components"),x=f.append("g").attr("transform",`translate(${s}, ${i})`);return{svg:y,coreChartHeight:c,allComponents:f,chartCore:x,widgetsLeft:h,widgetsRight:u,viewBoxWidth:m}}({chartContainerSelector:D,coreChartWidth:E,aspectRatio:x,marginTop:g,marginBottom:u,marginLeft:y,marginRight:h,bgColor:f}),G=o.select("body").append("div").attr("class","dom-tooltip").attr("style","opacity: 0; position: absolute; background-color: white; border-radius: 0.25rem; padding: 0.25rem 0.5rem; font-size: 0.75rem; line-height: 1rem; border-width: 1px;"),{dataParsed:H,dataAt:Y,timeDomain:j,timeDomainLength:q}=function({data:e,xField:t,yField:a,sizeField:i,timeField:n}){const s=e.map((e=>({...e,[i]:Number.parseFloat(e[i]),[t]:Number.parseFloat(e[t]),[a]:Number.parseFloat(e[a])}))),o=t=>e.filter((e=>e[n]===t)),l=r.default.uniq(r.default.map(e,n)).sort(),c=l.length;return{dataParsed:s,dataAt:o,timeDomain:l,timeDomainLength:c}}({data:e,xField:a,yField:i,sizeField:t,timeField:n}),{sizeScale:M,xScale:_,yScale:X,colorScale:J}=function({dataParsed:e,sizeField:t,sizeRange:a,xDomainCustom:i,yDomainCustom:n,xField:s,yField:l,colorField:c,coreChartWidth:d,coreChartHeight:m,inbuiltScheme:p,numberOfColors:g}){const h=e.map((e=>e[t])),u=o.extent(h),y=t?o.scaleSqrt().domain([0,u[1]]).range(a):()=>a[0],f=i||o.extent(e.map((e=>e[s]))),x=n||o.extent(e.map((e=>e[l]))),v=o.scaleLinear().domain(f).range([0,d]),b=o.scaleLinear().range([m,0]).domain(x),F=r.default.uniq(r.default.map(e,c)),S=o.scaleOrdinal(F,o[p][g]);return{sizeScale:y,xScale:v,yScale:b,colorScale:S}}({dataParsed:H,sizeField:t,sizeRange:v,xDomainCustom:F,yDomainCustom:$,xField:a,yField:i,colorField:c,coreChartWidth:E,coreChartHeight:O,inbuiltScheme:L,numberOfColors:z}),{startButton:Q,stopButton:U,rangeSlider:K,rangeSliderValue:Z}=function({widgetsLeft:e,timeField:t,startButtonClassNames:a,stopButtonClassNames:i}){const n=e.append("button").text("Start").attr("id","#start").attr("class",a),s=e.append("button").text("Stop").attr("id","#stop").attr("class",i),o=e.append("div").attr("style","display: flex; flex-direction: column; align-items: center; font-size: 0.75rem");o.append("label").text(t).attr("for","#range-slider").attr("style","text-transform: capitalize");const r=o.append("input").attr("type","range").attr("id","range-slider"),l=o.append("span");return{startButton:n,stopButton:s,rangeSlider:r,rangeSliderValue:l}}({widgetsLeft:W,timeField:n,startButtonClassNames:R,stopButtonClassNames:T});Z.text(j[0]),U.node().disabled=!0;const ee=function({chartCore:e,dataAt:t,timeDomain:a,nameField:i,sizeField:n,xScale:s,yScale:r,xField:l,yField:c,timeField:m,colorField:p,xValueFormatter:g,yValueFormatter:h,sizeValueFormatter:u,sizeScale:y,colorScale:f,activeOpacity:x,tooltipDiv:v}){return e.append("g").attr("class","group-circles").selectAll("circle").data(t(a[0]),(e=>e[i])).join("circle").sort(((e,t)=>o.descending(e[n],t[n]))).attr("class",(e=>`iv-circle iv-circle-${d(e[i])}`)).attr("cx",(e=>s(e[l]))).attr("cy",(e=>r(e[c]))).attr("r",(e=>y(e[n]))).attr("fill",(e=>f(e[p]))).attr("opacity",x).attr("stroke",(e=>o.rgb(f(e[p])).darker(.5))).on("mouseover",((e,t)=>{v.transition().duration(200).style("opacity",1),v.html(`${t[i]} (${t[m]})\n      <br/>\n      <div style="text-transform: capitalize">\n      <span> ${l}: ${g(t[l])}</span>\n      <br/>\n      <span>${c}: ${h(t[c])}</span>\n      <br/>\n      ${n?`<span>${n}: ${u(t[n])}</span>`:""}\n      </div>\n      `),o.select(e.target).attr("stroke-width",2),v.style("left",`${e.clientX}px`).style("top",`${e.clientY+20+window.scrollY}px`)})).on("mouseout",(e=>{o.select(e.target).attr("stroke-width",1),v.style("left","-300px").transition().duration(500).style("opacity",0)}))}({chartCore:V,dataAt:Y,timeDomain:j,nameField:s,sizeField:t,xScale:_,yScale:X,xField:a,yField:i,timeField:n,colorField:c,xValueFormatter:e=>l(e,C),yValueFormatter:e=>l(e,k),sizeValueFormatter:e=>l(e,b),sizeScale:M,colorScale:J,activeOpacity:A,tooltipDiv:G});!function({rangeSlider:e,timeDomainLength:t,timeDomain:a,rangeSliderValue:i,dataAt:n,updateCircles:s,startButton:o,stopButton:r,intervalId:l,motionDelay:c}){e.attr("min",0).attr("max",t-1).attr("value",0).on("input",(e=>{const t=Number.parseInt(e.target.value,10);i.text(a[t]),s(n(a[t]))})),o.on("click",(()=>{o.node().disabled=!0,r.node().disabled=!1,Number.parseInt(e.node().value,10)===Number.parseInt(t-1,10)&&(e.node().value=0,i.text(a[0]),s(n(a[0]))),l=window.setInterval((()=>{if(Number.parseInt(e.node().value,10)===Number.parseInt(t-1,10))return window.clearInterval(l),o.node().disabled=!1,void(r.node().disabled=!0);e.node().value++;const c=Number.parseInt(e.node().value,10);i.text(a[c]),s(n(a[c]))}),c)})),r.on("click",(()=>{r.node().disabled=!0,o.node().disabled=!1,window.clearInterval(l)}))}({rangeSlider:K,timeDomainLength:q,timeDomain:j,rangeSliderValue:Z,dataAt:Y,updateCircles:e=>{ee.data(e,(e=>e[s])).sort(((e,a)=>o.descending(e[t],a[t]))).transition().duration(p).attr("cx",(e=>_(e[a]))).attr("cy",(e=>X(e[i]))).attr("r",(e=>M(e[t])))},startButton:Q,stopButton:U,intervalId:undefined,motionDelay:p}),function({widgetsLeft:e,nameField:t,searchButtonClassNames:a,circles:i,sizeField:n}){function s(e){if(e){o.select(".group-circles").classed("searching",!0);const a=[];i.classed("s-match",(i=>{const n=i[t].toLowerCase().includes(e.toLowerCase());return n&&a.push(`.iv-circle-${d(i[t])}`),n})),a.forEach((e=>{o.select(e).raise()}))}else o.select(".group-circles").classed("searching",!1),i.sort(((e,t)=>o.descending(e[n],t[n])))}e.append("input").attr("type","text").attr("placeholder",`Find by ${t}`).attr("class",a).on("keyup",(e=>{s(e.target.value.trim())}))}({widgetsLeft:W,nameField:s,searchButtonClassNames:N,circles:ee,sizeField:t}),function({chartCore:e,coreChartHeight:t,coreChartWidth:a,xScale:i,xAxisLabel:n}){const s=e.append("g").attr("class","x-axis").lower();s.attr("transform",`translate(0, ${t})`).call(o.axisBottom(i).tickSize(-t-6)).style("color","#777").call((e=>{e.selectAll(".tick line").style("color","#ddd").attr("transform","translate(0, 6)"),e.selectAll(".tick text").attr("transform","translate(0, 6)"),e.select(".domain").remove()})),s.append("text").attr("transform",`translate(${a/2}, 35)`).style("text-anchor","middle").style("dominant-baseline","top").style("fill","#333").style("font-size","12px").style("font-weight","bold").text(n)}({chartCore:V,coreChartHeight:O,coreChartWidth:E,xScale:_,xAxisLabel:S}),function({chartCore:e,coreChartWidth:t,coreChartHeight:a,yScale:i,yAxisLabel:n}){const s=e.append("g").attr("class","y-axis").lower();s.append("g").call(o.axisLeft(i).tickSize(-t-6)).style("color","#777").call((e=>{e.selectAll(".tick line").style("color","#ddd").attr("transform","translate(-6, 0)"),e.selectAll(".tick text").attr("transform","translate(-6, 0)"),e.select(".domain").remove()})).attr("class","y-axis"),s.append("text").attr("transform",`translate(-35, ${a/2}), rotate(-90)`).style("text-anchor","middle").style("dominant-baseline","hanging").style("fill","#333").style("font-size","12px").style("font-weight","bold").text(n)}({chartCore:V,coreChartWidth:E,coreChartHeight:O,yScale:X,yAxisLabel:w}),m({allComponents:P,svg:I,margins:{marginLeft:y,marginRight:h,marginTop:g,marginBottom:u}})}const ie={sizeField:[],xField:[b,x],yField:[b,x],timeField:[b],nameField:[b],colorField:[]},ne={aspectRatio:$([.01,Number.POSITIVE_INFINITY]),marginTop:C,marginRight:C,marginBottom:C,marginLeft:C,bgColor:w,sizeRange:L,xDomainCustom:L,yDomainCustom:L,inbuiltScheme:S(H),numberOfColors:$([3,9])};function se({data:e,options:{aspectRatio:t=.8,marginTop:a=0,marginRight:i=0,marginBottom:n=0,marginLeft:s=0,bgColor:p="transparent",sizeLegendLabel:g=r.default.capitalize(j),sizeLegendValues:h=[1,5,10,20],sizeLegendGapInSymbols:u=25,sizeLegendMoveSymbolsDownBy:y=15,xDomain:f,xAxisLabel:x=G,xAxisLabelOffset:v=-40,xAxisValueFormatter:b="",yAxisDateParser:F="",yAxisDateFormatter:S="",colorLegendValueFormatter:C="",sizeLegendValueFormatter:$="",sizeValueFormatter:w="",colorDomain:k,colorRange:L,colorLegendLabel:z,sizeRange:B=[2,20],sizeScaleType:A="linear",sizeScaleLogBase:R=10,dominoHeight:T=.3,yPaddingOuter:N=.1,initialState:D=[],activeOpacity:E=1,inactiveOpacity:I=.1,searchInputClassNames:O="",goToInitialStateButtonClassNames:V="",clearAllButtonClassNames:W=""},dimensions:{xField:G,yField:H,dominoField:Y,sizeField:j,colorField:q},chartContainerSelector:M}){!function({inactiveOpacity:e,activeOpacity:t}){o.select("body").append("style").html(`\n     .g-ribbons .ribbon {\n        fill-opacity: ${e};\n      }\n      .g-ribbons .ribbon.ribbon-active {\n        fill-opacity: ${t};\n      }\n      .g-ribbons.searching .ribbon.ribbon-matched {\n        stroke: #333;\n        stroke-width: 1;\n      }\n      .g-ribbons .ribbon.ribbon-hovered {\n        stroke: #333;\n        stroke-width: 1;\n      }\n      .domino-hovered {\n        stroke: #333;\n        stroke-width: 1;\n      }\n      .domino-matched {\n        stroke: #333;\n        stroke-width: 1;\n      }\n  `)}({inactiveOpacity:I,activeOpacity:E});const _=1e3,{svg:X,coreChartHeight:J,allComponents:Q,chartCore:U,widgetsLeft:K,widgetsRight:Z}=function({chartContainerSelector:e,coreChartWidth:t,aspectRatio:a,marginTop:i,marginBottom:n,marginLeft:s,marginRight:r,bgColor:l}){const c=t/a,d=c+i+n,m=t+s+r,p=o.select(e),g=p.append("div").attr("style","display: flex; justify-content: space-between; padding-bottom: 0.5rem;"),h=g.append("div").attr("style","display: flex; align-items: end; column-gap: 5px;"),u=g.append("div").attr("style","display: flex; align-items: center; column-gap: 10px;"),y=p.append("svg").attr("viewBox",`0 0 ${m} ${d}`).style("background",l),f=y.append("g").attr("class","all-components"),x=f.append("g").attr("transform",`translate(${s}, ${i})`);return{svg:y,coreChartHeight:c,allComponents:f,chartCore:x,widgetsLeft:h,widgetsRight:u}}({chartContainerSelector:M,coreChartWidth:_,aspectRatio:t,marginTop:a,marginBottom:n,marginLeft:s,marginRight:i,bgColor:p}),ee=o.select("body").append("div").attr("class","dom-tooltip").attr("style","opacity: 0; position: absolute; background-color: white; border-radius: 0.25rem; padding: 0.25rem 0.5rem; font-size: 0.75rem; line-height: 1rem; border-width: 1px;"),{allDominoFieldValues:te,defaultStateAll:ae}=function({data:e,dominoField:t,initialState:a}){const i=r.default.chain(e).map(t).uniq().value(),n=r.default(e).map(t).uniq().value();return{allDominoFieldValues:i,defaultStateAll:"All"===a?n:a}}({data:e,dominoField:Y,initialState:D}),{xScale:ie,yScale:ne,colorScale:se,sizeScale:oe,yDomain:re}=function({data:e,xField:t,yField:a,sizeField:i,colorField:n,colorRange:s,colorDomain:l,xDomain:c,coreChartWidth:d,coreChartHeight:m,yPaddingOuter:p,dominoHeight:g,sizeScaleType:h,sizeScaleLogBase:u,sizeRange:y}){const f=1-g,x=o.scaleBand().range([0,m]).paddingInner(f).paddingOuter(p),v=o.scaleLinear().range([0,d]),b="log"===h?o.scaleLog().base(u||10).range(y):o.scaleLinear().range(y),F=r.default.chain(e).map(a).uniq().value().sort(),S=o.extent(r.default.chain(e).map(t).uniq().value((e=>Number.parseFloat(e))));x.domain(F),v.domain((c||S).slice());const C=o.extent(r.default.chain(e).map(i).uniq().value((e=>Number.parseFloat(e))));b.domain(C);const $=o.extent(e.map((e=>Number.parseFloat(e[n])))),w=[0,2,3,6],k=o.schemeSpectral[9].filter(((e,t)=>w.indexOf(t)>-1)).slice().reverse();return{xScale:v,yScale:x,colorScale:o.scaleQuantize().range(s||k).domain(l||$).nice(),sizeScale:b,yDomain:F}}({data:e,xField:G,yField:H,sizeField:j,colorField:q,colorRange:L,colorDomain:k,xDomain:f,coreChartWidth:_,coreChartHeight:J,yPaddingOuter:N,dominoHeight:T,sizeScaleType:A,sizeScaleLogBase:R,sizeRange:B});!function({chartCore:e,xAxisLabel:t,coreChartWidth:a,xAxisLabelOffset:i,yScale:n,yDomain:s,xScale:r,coreChartHeight:l,formatNumber:c,xAxisValueFormatter:d}){e.append("g").append("text").attr("class","font-sans x-axis-label").text(t).attr("text-anchor","middle").attr("alignment-baseline","middle").attr("transform",`translate(${a/2}, ${i})`).style("font-size","12px").style("font-weight",600).style("text-transform","capitalize"),e.append("g").attr("class","x-axis-top").attr("transform",`translate(0, ${n(s[0])-30})`).call(o.axisTop(r).tickSize(-l).tickFormat((e=>c(e,d)))).call((e=>e.select(".domain").remove())).call((e=>e.selectAll(".tick line").attr("stroke-opacity",.2)))}({chartCore:U,xAxisLabel:x,coreChartWidth:_,xAxisLabelOffset:v,yScale:ne,yDomain:re,xScale:ie,coreChartHeight:J,formatNumber:l,xAxisValueFormatter:b}),function({chartCore:e,xScale:t,xDomain:a,yScale:i,formatDate:n,yAxisDateParser:s,yAxisDateFormatter:r}){e.append("g").attr("class","y-axis-right").attr("transform",`translate(${t(a[1])+20}, 0)`).call(o.axisRight(i).tickSize(0).tickFormat((e=>n(e,s,r)))).call((e=>e.select(".domain").remove()))}({chartCore:U,xScale:ie,xDomain:f,yScale:ne,formatDate:c,yAxisDateParser:F,yAxisDateFormatter:S}),function({data:e,yField:t,sizeField:a,sizeScale:i,xAxisValueFormatter:n,yAxisDateParser:s,yAxisDateFormatter:m,sizeValueFormatter:p,chartCore:g,yScale:h,dominoField:u,xScale:y,xField:f,colorScale:x,colorField:v,tooltipDiv:b,allDominoFieldValues:F,defaultStateAll:S}){const C=g.append("g").attr("class","g-ribbons"),$=[];e.forEach((e=>{const n=y(e[f])-i(e[a])/2,s=n+i(e[a]),o=h(e[t]);$.push({...e,x0:n,x1:s,y0:o},{...e,x0:n,x1:s,y0:o+h.bandwidth()})}));const w=o.area().curve(o.curveMonotoneY).y((e=>e.y0)).x0((e=>e.x0)).x1((e=>e.x1));g.append("g").attr("class","g-dominos").selectAll("rect").data(e).join("rect").attr("class",(e=>`\n      domino-${d(e[u])}\n      ${S.includes(e[u])?"domino-active":""}\n    `)).attr("x",(e=>y(e[f])-i(e[a])/2)).attr("y",(e=>h(e[t]))).attr("width",(e=>i(e[a]))).attr("height",h.bandwidth()).attr("fill",(e=>x(Number.parseFloat(e[v])))).attr("stroke",(e=>o.rgb(x(Number.parseFloat(e[v]))).darker(.5))).on("mouseover",((e,i)=>{const r=l(i[f],n),g=c(i[t],s,m),h=l(i[a],p);b.transition().duration(200).style("opacity",1),b.html(`<div>${i[u]} (${g})</div>\n          <div style="text-transform: capitalize">${f}: ${r}</div>\n          <div style="text-transform: capitalize">${a}: ${h}</div>\n         </div>`),o.select(e.target).raise();const y=d(i[u]);o.select(`.ribbon-${y}`).classed("ribbon-hovered",!0),o.selectAll(`.domino-${y}`).raise().classed("domino-hovered",!0),o.select(".g-ribbons").classed("hovered",!0),b.style("left",`${e.clientX}px`).style("top",`${e.clientY+20+window.scrollY}px`)})).on("mouseout",((e,t)=>{b.style("left","-300px").transition().duration(500).style("opacity",0);const a=d(t[u]);o.select(`.ribbon-${a}`).classed("ribbon-hovered",!1),o.selectAll(`.domino-${a}`).classed("domino-hovered",!1),o.select(e.target).lower(),o.select(".g-ribbons").classed("hovered",!1)})).on("click",((e,t)=>{const a=d(t[u]),i=o.select(`.ribbon-${a}`).classed("ribbon-active");o.select(`.ribbon-${a}`).classed("ribbon-active",!i)})),C.selectAll("path").data(r.default.chain(e).map(u).uniq().value()).join("path").attr("fill",(e=>`url(#gradient-${d(e)})`)).attr("class",(e=>`\n      ribbon\n      ribbon-${d(e)}\n      ${S.includes(e)?"ribbon-active":""}`)).attr("d",(e=>w(r.default.filter($,{[u]:e})))).on("mouseover",((e,t)=>{const a=d(t);o.select(`.ribbon-${a}`).classed("ribbon-hovered",!0),o.selectAll(`.domino-${a}`).classed("domino-hovered",!0).raise(),o.select(".g-ribbons").classed("hovered",!0)})).on("mouseout",((e,t)=>{const a=d(t);o.select(`.ribbon-${a}`).classed("ribbon-hovered",!1),o.selectAll(`.domino-${a}`).classed("domino-hovered",!1).lower(),o.select(".g-ribbons").classed("hovered",!1)})).on("click",(e=>{const t=o.select(e.target).classed("ribbon-active");o.select(e.target).classed("ribbon-active",!t)}));const k=g.append("defs");F.forEach((e=>{const t=k.append("linearGradient").attr("id",`gradient-${d(e)}`).attr("x1","100%").attr("x2","100%").attr("y1","0%").attr("y2","100%"),a=r.default.chain($).filter({[u]:e}).sortBy().value();a.forEach((e=>{t.append("stop").attr("offset",100*(e.y0-a[0].y0)/(a[a.length-1].y0-a[0].y0)+"%").attr("stop-color",x(e[v]))}))}))}({data:e,yField:H,sizeField:j,sizeScale:oe,xAxisValueFormatter:b,yAxisDateParser:F,yAxisDateFormatter:S,sizeValueFormatter:w,chartCore:U,yScale:ne,dominoField:Y,xScale:ie,xField:G,colorScale:se,colorField:q,tooltipDiv:ee,allDominoFieldValues:te,defaultStateAll:ae});const le=(ce=te,e=>{if(e){const t=e.toLowerCase();ce.forEach((e=>{const a=d(e);e.toLowerCase().includes(t)?(o.select(`.ribbon-${a}`).classed("ribbon-matched",!0),o.selectAll(`.domino-${a}`).classed("domino-matched",!0),o.select(".g-ribbons").classed("searching",!0)):(o.select(`.ribbon-${a}`).classed("ribbon-matched",!1),o.selectAll(`.domino-${a}`).classed("domino-matched",!1))}))}else ce.forEach((e=>{const t=d(e);o.select(`.ribbon-${t}`).classed("ribbon-matched",!1),o.selectAll(`.domino-${t}`).classed("domino-matched",!1)})),o.select(".g-ribbons").classed("searching",!1)});var ce;const de=function({handleSearch:e,widgetsLeft:t,searchInputClassNames:a,dominoField:i}){const n=t.append("input").attr("type","text").attr("class",a);return n.attr("placeholder",`Find by ${i}`),n.on("keyup",(t=>{const a=t.target.value;e(a)})),n}({handleSearch:le,widgetsLeft:K,searchInputClassNames:O,dominoField:Y});!function({widgetsLeft:e,goToInitialStateButtonClassNames:t,defaultStateAll:a,search:i,handleSearch:n}){e.append("button").text("Go to Initial State").attr("class",t).on("click",(()=>{o.selectAll(".ribbon").classed("ribbon-active",!1),r.default.forEach(a,(e=>{o.select(`.ribbon-${d(e)}`).classed("ribbon-active",!0)})),i.node().value="",n("")}))}({widgetsLeft:K,goToInitialStateButtonClassNames:V,defaultStateAll:ae,search:de,handleSearch:le}),function({widgetsLeft:e,clearAllButtonClassNames:t,search:a,handleSearch:i}){e.append("button").text("Clear All").attr("class",t).on("click",(()=>{o.selectAll(".ribbon").classed("ribbon-active",!1),a.node().value="",i("")}))}({widgetsLeft:K,clearAllButtonClassNames:W,search:de,handleSearch:le}),function({colorScale:e,colorLegendLabel:t,widgetsRight:a,colorField:i,colorLegendValueFormatter:n}){a.append((()=>P({color:e,title:t||r.default.capitalize(i),width:260,tickFormat:e=>l(e,n)})))}({colorScale:se,colorLegendLabel:z,widgetsRight:Z,colorField:q,colorLegendValueFormatter:C}),function({widgetsRight:e,sizeLegendValues:t,sizeLegendMoveSymbolsDownBy:a,sizeScale:i,sizeLegendGapInSymbols:n,sizeLegendValueFormatter:s,sizeLegendLabel:o}){const r=e.append("svg"),c=r.append("g");c.append("g").attr("class","g-size-container").attr("transform",`translate(0, ${a})`).selectAll(".g-size-dominos").data(t).enter().append("g").attr("class","g-size-dominos").append("rect").style("fill","#bebebe").style("stroke-width",1).style("stroke","gray").attr("width",(e=>i(e))).attr("height",25).attr("x",((e,t)=>i(e)+t*n)),c.selectAll(".g-size-dominos").append("text").attr("dy",35).attr("dx",((e,t)=>1.5*i(e)+t*n)).attr("text-anchor","middle").style("font-size",8).text((e=>l(e,s))),c.append("text").attr("alignment-baseline","hanging").style("font-size",10).style("font-weight",600).text(o);const d=c.node().getBBox();r.attr("height",d.height).attr("width",d.width)}({widgetsRight:Z,sizeLegendValues:h,sizeLegendMoveSymbolsDownBy:y,sizeScale:oe,sizeLegendGapInSymbols:u,sizeLegendValueFormatter:$,sizeLegendLabel:g}),m({allComponents:Q,svg:X,margins:{marginLeft:s,marginRight:i,marginTop:a,marginBottom:n}})}const oe={xField:[x],yField:[b],dominoField:[b],sizeField:[x],colorField:[x]},re={aspectRatio:$([0,Number.POSITIVE_INFINITY]),marginTop:C,marginRight:C,marginBottom:C,marginLeft:C,bgColor:w,xDomain:L,xAxisLabelOffset:C,dominoHeight:$([0,1]),sizeScaleType:S(["log","linear"]),sizeRange:L,sizeLegendValues:L,sizeLegendGapInSymbols:C,sizeLegendMoveSymbolsDownBy:C,colorDomain:L,colorRange:k(),initialState:z,activeOpacity:$([0,1]),inactiveOpacity:$([0,1])};e.renderBubbleHorizontal=G,e.renderCalendar=Z,e.renderDominoBase=q,e.renderDominoRibbon=se,e.renderMace=y,e.renderMotionBubble=ae,e.renderRidgeline=J,e.renderSankey=E,e.validateAndRenderBubbleHorizontal=({dataPath:e,options:t,dimensions:a,chartContainerSelector:i})=>{const n=F({optionTypes:j,options:t});o.csv(e).then((e=>{const{columns:s}=e,o=B({columns:s,dimensions:a}),r=f({data:e,dimensionTypes:Y,dimensions:a}),l={valid:!0,messages:[]};[o,r,n].forEach((e=>{l.valid=l.valid&&e.valid,e.valid||l.messages.push(e.message)})),l.valid?G({data:e,dimensions:a,options:t,chartContainerSelector:i}):A(i,l.messages)}))},e.validateAndRenderCalendar=({dataPath:e,options:t,dimensions:a,chartContainerSelector:i})=>{o[(e=>{const[t]=e.split(".").slice(-1);return t})(e)](e).then((e=>{const{columns:n}=e,{flatDimensions:s,dimensionTypesWYFields:o,optionTypesWYFields:l}=function({dimensions:e,dimensionTypes:t,optionTypes:a}){const i={},n={},s=e.yFields;var o;return s.forEach(((e,t)=>{i[`__yField${t}__`]=[x],n[`__yField${t}__`]=e})),{flatDimensions:{...e,...n},dimensionTypesWYFields:{...t,...i},optionTypesWYFields:{...a,yFieldLabels:(o=s.length,e=>r.default.isArray(e)?o&&e.length<o?{valid:!1,message:`Should be an array with minimum length: ${o}`}:{valid:!0}:{valid:!1,message:"Should be a valid array"}),colorScheme:k(s.length)}}}({dimensions:a,dimensionTypes:ee,optionTypes:te}),c=F({optionTypes:l,options:t}),d=B({columns:n,dimensions:s}),m=f({data:e,dimensionTypes:o,dimensions:s}),p={valid:!0,messages:[]};[d,m,c].forEach((e=>{p.valid=p.valid&&e.valid,e.valid||p.messages.push(e.message)})),p.valid?Z({data:e,dimensions:a,options:t,chartContainerSelector:i}):A(i,p.messages)}))},e.validateAndRenderDominoBase=({dataPath:e,options:t,dimensions:a,chartContainerSelector:i})=>{const n=F({optionTypes:_,options:t});o.csv(e).then((e=>{const{columns:s}=e,o=B({columns:s,dimensions:a}),r=f({data:e,dimensionTypes:M,dimensions:a}),l={valid:!0,messages:[]};[o,r,n].forEach((e=>{l.valid=l.valid&&e.valid,e.valid||l.messages.push(e.message)})),l.valid?q({data:e,dimensions:a,options:t,chartContainerSelector:i}):A(i,l.messages)}))},e.validateAndRenderDominoRibbon=({dataPath:e,options:t,dimensions:a,chartContainerSelector:i})=>{const n=F({optionTypes:re,options:t});o.csv(e).then((e=>{const{columns:s}=e,o=B({columns:s,dimensions:a}),r=f({data:e,dimensionTypes:oe,dimensions:a}),l={valid:!0,messages:[]};[o,r,n].forEach((e=>{l.valid=l.valid&&e.valid,e.valid||l.messages.push(e.message)})),l.valid?se({data:e,dimensions:a,options:t,chartContainerSelector:i}):A(i,l.messages)}))},e.validateAndRenderMace=({dataPath:e,options:t,dimensions:a,chartContainerSelector:i})=>{const n=F({optionTypes:T,options:t});o.csv(e).then((e=>{const{columns:s}=e,o=B({columns:s,dimensions:a}),r=f({data:e,dimensionTypes:R,dimensions:a}),l={valid:!0,messages:[]};[o,r,n].forEach((e=>{l.valid=l.valid&&e.valid,e.valid||l.messages.push(e.message)})),l.valid?y({data:e,dimensions:a,options:t,chartContainerSelector:i}):A(i,l.messages)}))},e.validateAndRenderMotionBubble=({dataPath:e,options:t,dimensions:a,chartContainerSelector:i})=>{const n=F({optionTypes:ne,options:t});o.csv(e).then((e=>{const{columns:s}=e,o=B({columns:s,dimensions:a}),r=f({data:e,dimensionTypes:ie,dimensions:a}),l={valid:!0,messages:[]};[o,r,n].forEach((e=>{l.valid=l.valid&&e.valid,e.valid||l.messages.push(e.message)})),l.valid?ae({data:e,dimensions:a,options:t,chartContainerSelector:i}):A(i,l.messages)}))},e.validateAndRenderRidgeline=({dataPath:e,options:t,dimensions:a,chartContainerSelector:i})=>{const n=F({optionTypes:U,options:t});o.csv(e).then((e=>{const{columns:s}=e,o=B({columns:s,dimensions:a}),r=f({data:e,dimensionTypes:Q,dimensions:a}),l={valid:!0,messages:[]};[o,r,n].forEach((e=>{l.valid=l.valid&&e.valid,e.valid||l.messages.push(e.message)})),l.valid?J({data:e,dimensions:a,options:t,chartContainerSelector:i}):A(i,l.messages)}))},e.validateAndRenderSankey=({dataPath:e,options:t,dimensions:a,chartContainerSelector:i})=>{const n=F({optionTypes:O,options:t});o.csv(e).then((e=>{const{columns:s}=e,o=B({columns:s,dimensions:a}),r=f({data:e,dimensionTypes:I,dimensions:a}),l={valid:!0,messages:[]};[o,r,n].forEach((e=>{l.valid=l.valid&&e.valid,e.valid||l.messages.push(e.message)})),l.valid?E({data:e,dimensions:a,options:t,chartContainerSelector:i}):A(i,l.messages)}))},Object.defineProperty(e,"__esModule",{value:!0})}));
